---
title: Host ASP.NET Core in Windows con IIS
author: guardrex
description: Informazioni su come ospitare app ASP.NET Core in Windows Server Internet Information Services (IIS).
monikerRange: '>= aspnetcore-2.1'
ms.author: riande
ms.custom: mvc
ms.date: 10/13/2019
uid: host-and-deploy/iis/index
ms.openlocfilehash: bf535134277a08103ba8ce55eeed540a9fce8260
ms.sourcegitcommit: 07d98ada57f2a5f6d809d44bdad7a15013109549
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/15/2019
ms.locfileid: "72333873"
---
# <a name="host-aspnet-core-on-windows-with-iis"></a><span data-ttu-id="4a39e-103">Host ASP.NET Core in Windows con IIS</span><span class="sxs-lookup"><span data-stu-id="4a39e-103">Host ASP.NET Core on Windows with IIS</span></span>

<span data-ttu-id="4a39e-104">Di [Luke Latham](https://github.com/guardrex)</span><span class="sxs-lookup"><span data-stu-id="4a39e-104">By [Luke Latham](https://github.com/guardrex)</span></span>

<span data-ttu-id="4a39e-105">Per un'esercitazione sulla pubblicazione di un'app ASP.NET Core in un server IIS, vedere <xref:tutorials/publish-to-iis>.</span><span class="sxs-lookup"><span data-stu-id="4a39e-105">For a tutorial experience on publishing an ASP.NET Core app to an IIS server, see <xref:tutorials/publish-to-iis>.</span></span>

[<span data-ttu-id="4a39e-106">Installare il bundle di hosting .NET Core</span><span class="sxs-lookup"><span data-stu-id="4a39e-106">Install the .NET Core Hosting Bundle</span></span>](#install-the-net-core-hosting-bundle)

## <a name="supported-operating-systems"></a><span data-ttu-id="4a39e-107">Supported operating systems</span><span class="sxs-lookup"><span data-stu-id="4a39e-107">Supported operating systems</span></span>

<span data-ttu-id="4a39e-108">Sono supportati i sistemi operativi seguenti:</span><span class="sxs-lookup"><span data-stu-id="4a39e-108">The following operating systems are supported:</span></span>

* <span data-ttu-id="4a39e-109">Windows 7 o versione successiva</span><span class="sxs-lookup"><span data-stu-id="4a39e-109">Windows 7 or later</span></span>
* <span data-ttu-id="4a39e-110">Windows Server 2008 R2 o versioni successive</span><span class="sxs-lookup"><span data-stu-id="4a39e-110">Windows Server 2008 R2 or later</span></span>

<span data-ttu-id="4a39e-111">Il [server HTTP.sys](xref:fundamentals/servers/httpsys) (chiamato in precedenza WebListener) non funziona in una configurazione proxy inverso con IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-111">[HTTP.sys server](xref:fundamentals/servers/httpsys) (formerly called WebListener) doesn't work in a reverse proxy configuration with IIS.</span></span> <span data-ttu-id="4a39e-112">È necessario usare il [server Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="4a39e-112">Use the [Kestrel server](xref:fundamentals/servers/kestrel).</span></span>

<span data-ttu-id="4a39e-113">Per informazioni sull'hosting in Azure, vedere <xref:host-and-deploy/azure-apps/index>.</span><span class="sxs-lookup"><span data-stu-id="4a39e-113">For information on hosting in Azure, see <xref:host-and-deploy/azure-apps/index>.</span></span>

<span data-ttu-id="4a39e-114">Per linee guida per la risoluzione dei problemi, vedere <xref:test/troubleshoot>.</span><span class="sxs-lookup"><span data-stu-id="4a39e-114">For troubleshooting guidance, see <xref:test/troubleshoot>.</span></span>

## <a name="supported-platforms"></a><span data-ttu-id="4a39e-115">Piattaforme supportate</span><span class="sxs-lookup"><span data-stu-id="4a39e-115">Supported platforms</span></span>

<span data-ttu-id="4a39e-116">Sono supportate le app pubblicate per la distribuzione a 32 bit (x86) o a 64 bit (x64).</span><span class="sxs-lookup"><span data-stu-id="4a39e-116">Apps published for 32-bit (x86) or 64-bit (x64) deployment are supported.</span></span> <span data-ttu-id="4a39e-117">Distribuire un'app a 32 bit con .NET Core SDK a 32 bit (x86), a meno che l'app:</span><span class="sxs-lookup"><span data-stu-id="4a39e-117">Deploy a 32-bit app with a 32-bit (x86) .NET Core SDK unless the app:</span></span>

* <span data-ttu-id="4a39e-118">Non richieda lo spazio indirizzi di memoria virtuale più grande disponibile per un'app a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="4a39e-118">Requires the larger virtual memory address space available to a 64-bit app.</span></span>
* <span data-ttu-id="4a39e-119">Non richieda le dimensioni maggiori dello stack IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-119">Requires the larger IIS stack size.</span></span>
* <span data-ttu-id="4a39e-120">Non abbia dipendenze native a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="4a39e-120">Has 64-bit native dependencies.</span></span>

<span data-ttu-id="4a39e-121">Usare .NET Core SDK a 64 bit (x64) per pubblicare un'app a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="4a39e-121">Use a 64-bit (x64) .NET Core SDK to publish a 64-bit app.</span></span> <span data-ttu-id="4a39e-122">Un runtime a 64 bit deve essere presente nel sistema host.</span><span class="sxs-lookup"><span data-stu-id="4a39e-122">A 64-bit runtime must be present on the host system.</span></span>

::: moniker range=">= aspnetcore-2.2"

## <a name="hosting-models"></a><span data-ttu-id="4a39e-123">Modelli di hosting</span><span class="sxs-lookup"><span data-stu-id="4a39e-123">Hosting models</span></span>

### <a name="in-process-hosting-model"></a><span data-ttu-id="4a39e-124">Modello di hosting in-process</span><span class="sxs-lookup"><span data-stu-id="4a39e-124">In-process hosting model</span></span>

<span data-ttu-id="4a39e-125">Se si usa l'hosting in-process, un'app ASP.NET Core esegue lo stesso processo del processo di lavoro IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-125">Using in-process hosting, an ASP.NET Core app runs in the same process as its IIS worker process.</span></span> <span data-ttu-id="4a39e-126">L'hosting in-process offre prestazioni migliori rispetto all'hosting out-of-process perché le richieste non vengono inserite in proxy sulla scheda di loopback, un'interfaccia di rete che restituisce il traffico di rete in uscita allo stesso computer.</span><span class="sxs-lookup"><span data-stu-id="4a39e-126">In-process hosting provides improved performance over out-of-process hosting because requests aren't proxied over the loopback adapter, a network interface that returns outgoing network traffic back to the same machine.</span></span> <span data-ttu-id="4a39e-127">Per gestire il processo, IIS usa il [servizio Attivazione processo Windows (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span><span class="sxs-lookup"><span data-stu-id="4a39e-127">IIS handles process management with the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="4a39e-128">Il [modulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module):</span><span class="sxs-lookup"><span data-stu-id="4a39e-128">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module):</span></span>

* <span data-ttu-id="4a39e-129">Esegue l'inizializzazione dell'app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-129">Performs app initialization.</span></span>
  * <span data-ttu-id="4a39e-130">Carica [CoreCLR](/dotnet/standard/glossary#coreclr).</span><span class="sxs-lookup"><span data-stu-id="4a39e-130">Loads the [CoreCLR](/dotnet/standard/glossary#coreclr).</span></span>
  * <span data-ttu-id="4a39e-131">Chiama `Program.Main`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-131">Calls `Program.Main`.</span></span>
* <span data-ttu-id="4a39e-132">Gestisce la durata della richiesta nativa di IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-132">Handles the lifetime of the IIS native request.</span></span>

<span data-ttu-id="4a39e-133">Il modello di hosting In-Process non è supportato per le app ASP.NET Core destinate a .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="4a39e-133">The in-process hosting model isn't supported for ASP.NET Core apps that target the .NET Framework.</span></span>

<span data-ttu-id="4a39e-134">Il diagramma seguente illustra la relazione tra IIS, il modulo ASP.NET Core e un'app ospitata in-process:</span><span class="sxs-lookup"><span data-stu-id="4a39e-134">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted in-process:</span></span>

![Modulo ASP.NET Core nello scenario di hosting in-process](index/_static/ancm-inprocess.png)

<span data-ttu-id="4a39e-136">Una richiesta arriva dal Web al driver HTTP.sys in modalità kernel.</span><span class="sxs-lookup"><span data-stu-id="4a39e-136">A request arrives from the web to the kernel-mode HTTP.sys driver.</span></span> <span data-ttu-id="4a39e-137">Il driver instrada la richiesta nativa IIS sulla porta configurata per il sito Web, in genere 80 (HTTP) o 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="4a39e-137">The driver routes the native request to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span> <span data-ttu-id="4a39e-138">Il modulo ASP.NET Core riceve la richiesta nativa e la passa al server HTTP IIS (`IISHttpServer`).</span><span class="sxs-lookup"><span data-stu-id="4a39e-138">The ASP.NET Core Module receives the native request and passes it to IIS HTTP Server (`IISHttpServer`).</span></span> <span data-ttu-id="4a39e-139">Il server HTTP di IIS è un'implementazione di server in-process per IIS che converte la richiesta da nativa a gestita.</span><span class="sxs-lookup"><span data-stu-id="4a39e-139">IIS HTTP Server is an in-process server implementation for IIS that converts the request from native to managed.</span></span>

<span data-ttu-id="4a39e-140">Dopo che la richiesta è stata elaborata dal server HTTP di IIS, viene eseguito il push della richiesta nella pipeline middleware ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="4a39e-140">After the IIS HTTP Server processes the request, the request is pushed into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="4a39e-141">La pipeline middleware gestisce la richiesta e la passa come istanza di `HttpContext` alla logica dell'app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-141">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="4a39e-142">La risposta dell'app viene restituita a IIS tramite il server HTTP di IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-142">The app's response is passed back to IIS through IIS HTTP Server.</span></span> <span data-ttu-id="4a39e-143">IIS invia la risposta al client che ha avviato la richiesta.</span><span class="sxs-lookup"><span data-stu-id="4a39e-143">IIS sends the response to the client that initiated the request.</span></span>

<span data-ttu-id="4a39e-144">L'hosting in-process è una funzionalità che richiede il consenso esplicito per le app esistenti, mentre i modelli [dotnet new](/dotnet/core/tools/dotnet-new) usano per impostazione predefinita il modello di hosting in-process per tutti gli scenari IIS e IIS Express.</span><span class="sxs-lookup"><span data-stu-id="4a39e-144">In-process hosting is opt-in for existing apps, but [dotnet new](/dotnet/core/tools/dotnet-new) templates default to the in-process hosting model for all IIS and IIS Express scenarios.</span></span>

<span data-ttu-id="4a39e-145">`CreateDefaultBuilder` aggiunge un'istanza di <xref:Microsoft.AspNetCore.Hosting.Server.IServer> chiamando il metodo <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIIS*> per avviare [CoreCLR](/dotnet/standard/glossary#coreclr) e ospitare l'app all'interno del processo di lavoro IIS (*w3wp.exe* o *iisexpress.exe*).</span><span class="sxs-lookup"><span data-stu-id="4a39e-145">`CreateDefaultBuilder` adds an <xref:Microsoft.AspNetCore.Hosting.Server.IServer> instance by calling the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIIS*> method to boot the [CoreCLR](/dotnet/standard/glossary#coreclr) and host the app inside of the IIS worker process (*w3wp.exe* or *iisexpress.exe*).</span></span> <span data-ttu-id="4a39e-146">I test delle prestazioni indicano che l'hosting di un'app .NET Core in-process offre una velocità effettiva delle richieste significativamente superiore rispetto all'hosting dell'app out-of-process o all'inoltro delle richieste al server [Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="4a39e-146">Performance tests indicate that hosting a .NET Core app in-process delivers significantly higher request throughput compared to hosting the app out-of-process and proxying requests to [Kestrel](xref:fundamentals/servers/kestrel) server.</span></span>

::: moniker-end

::: moniker range=">= aspnetcore-3.0"

> [!NOTE]
> <span data-ttu-id="4a39e-147">Le app pubblicate come un singolo file eseguibile non possono essere caricate dal modello di hosting in-process.</span><span class="sxs-lookup"><span data-stu-id="4a39e-147">Apps published as a single file executable can't be loaded by the in-process hosting model.</span></span>

::: moniker-end

::: moniker range=">= aspnetcore-2.2"

### <a name="out-of-process-hosting-model"></a><span data-ttu-id="4a39e-148">Modello di hosting out-of-process</span><span class="sxs-lookup"><span data-stu-id="4a39e-148">Out-of-process hosting model</span></span>

<span data-ttu-id="4a39e-149">Poiché le app ASP.NET Core vengono eseguite in un processo separato dal processo di lavoro IIS, il modulo ASP.NET Core gestisce la gestione dei processi.</span><span class="sxs-lookup"><span data-stu-id="4a39e-149">Because ASP.NET Core apps run in a process separate from the IIS worker process, the ASP.NET Core Module handles process management.</span></span> <span data-ttu-id="4a39e-150">Il modulo avvia il processo per l'app ASP.NET Core quando arriva la prima richiesta e riavvia l'app se viene arrestata o si arresta in modo anomalo.</span><span class="sxs-lookup"><span data-stu-id="4a39e-150">The module starts the process for the ASP.NET Core app when the first request arrives and restarts the app if it shuts down or crashes.</span></span> <span data-ttu-id="4a39e-151">Si tratta essenzialmente dello stesso comportamento delle app eseguite in-process e gestite dal [servizio Attivazione processo Windows](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span><span class="sxs-lookup"><span data-stu-id="4a39e-151">This is essentially the same behavior as seen with apps that run in-process that are managed by the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="4a39e-152">Il diagramma seguente illustra la relazione tra IIS, il modulo ASP.NET Core e un'app ospitata out-of-process:</span><span class="sxs-lookup"><span data-stu-id="4a39e-152">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted out-of-process:</span></span>

![Modulo ASP.NET Core nello scenario di hosting out-of-process](index/_static/ancm-outofprocess.png)

<span data-ttu-id="4a39e-154">Le richieste arrivano dal Web al driver HTTP.sys in modalità kernel.</span><span class="sxs-lookup"><span data-stu-id="4a39e-154">Requests arrive from the web to the kernel-mode HTTP.sys driver.</span></span> <span data-ttu-id="4a39e-155">Il driver instrada le richieste a IIS sulla porta configurata per il sito Web, in genere 80 (HTTP) o 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="4a39e-155">The driver routes the requests to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span> <span data-ttu-id="4a39e-156">Il modulo inoltra le richieste a Kestrel su una porta casuale per l'app non corrispondente alla porta 80 o 443.</span><span class="sxs-lookup"><span data-stu-id="4a39e-156">The module forwards the requests to Kestrel on a random port for the app, which isn't port 80 or 443.</span></span>

<span data-ttu-id="4a39e-157">Il modulo specifica la porta tramite una variabile di ambiente all'avvio e l'estensione <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> configura il server per l'ascolto su `http://localhost:{PORT}`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-157">The module specifies the port via an environment variable at startup, and the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> extension configures the server to listen on `http://localhost:{PORT}`.</span></span> <span data-ttu-id="4a39e-158">Vengono eseguiti controlli aggiuntivi e le richieste che non provengono dal modulo vengono rifiutate.</span><span class="sxs-lookup"><span data-stu-id="4a39e-158">Additional checks are performed, and requests that don't originate from the module are rejected.</span></span> <span data-ttu-id="4a39e-159">Il modulo non supporta l'inoltro HTTPS, pertanto le richieste vengono inoltrate tramite HTTP anche se sono state ricevute da IIS tramite HTTPS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-159">The module doesn't support HTTPS forwarding, so requests are forwarded over HTTP even if received by IIS over HTTPS.</span></span>

<span data-ttu-id="4a39e-160">Dopo che Kestrel ha prelevato la richiesta dal modulo, viene eseguito il push della richiesta nella pipeline middleware ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="4a39e-160">After Kestrel picks up the request from the module, the request is pushed into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="4a39e-161">La pipeline middleware gestisce la richiesta e la passa come istanza di `HttpContext` alla logica dell'app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-161">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="4a39e-162">Il middleware aggiunto dall'integrazione di IIS aggiorna lo schema, l'IP remoto e il percorso di base all'account per l'inoltro della richiesta a Kestrel.</span><span class="sxs-lookup"><span data-stu-id="4a39e-162">Middleware added by IIS Integration updates the scheme, remote IP, and pathbase to account for forwarding the request to Kestrel.</span></span> <span data-ttu-id="4a39e-163">La risposta dell'app viene quindi passata a IIS, che ne esegue di nuovo il push al client HTTP che ha avviato la richiesta.</span><span class="sxs-lookup"><span data-stu-id="4a39e-163">The app's response is passed back to IIS, which pushes it back out to the HTTP client that initiated the request.</span></span>

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="4a39e-164">ASP.NET Core viene fornito con il [server Kestrel](xref:fundamentals/servers/kestrel), ovvero un server HTTP multipiattaforma predefinito.</span><span class="sxs-lookup"><span data-stu-id="4a39e-164">ASP.NET Core ships with [Kestrel server](xref:fundamentals/servers/kestrel), a default, cross-platform HTTP server.</span></span>

<span data-ttu-id="4a39e-165">Quando si usa [IIS](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture) o [IIS Express](/iis/extensions/introduction-to-iis-express/iis-express-overview), l'app viene eseguita in un processo separato dal processo di lavoro IIS (*out-of-process*) con il [server Kestrel](xref:fundamentals/servers/index#kestrel).</span><span class="sxs-lookup"><span data-stu-id="4a39e-165">When using [IIS](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture) or [IIS Express](/iis/extensions/introduction-to-iis-express/iis-express-overview), the app runs in a process separate from the IIS worker process (*out-of-process*) with the [Kestrel server](xref:fundamentals/servers/index#kestrel).</span></span>

<span data-ttu-id="4a39e-166">Poiché le app ASP.NET Core vengono eseguite in un processo distinto dal processo di lavoro IIS, il modulo esegue la gestione dei processi.</span><span class="sxs-lookup"><span data-stu-id="4a39e-166">Because ASP.NET Core apps run in a process separate from the IIS worker process, the module handles process management.</span></span> <span data-ttu-id="4a39e-167">Il modulo avvia il processo per l'app ASP.NET Core quando arriva la prima richiesta e riavvia l'app se viene arrestata o si arresta in modo anomalo.</span><span class="sxs-lookup"><span data-stu-id="4a39e-167">The module starts the process for the ASP.NET Core app when the first request arrives and restarts the app if it shuts down or crashes.</span></span> <span data-ttu-id="4a39e-168">Si tratta essenzialmente dello stesso comportamento delle app eseguite in-process e gestite dal [servizio Attivazione processo Windows](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span><span class="sxs-lookup"><span data-stu-id="4a39e-168">This is essentially the same behavior as seen with apps that run in-process that are managed by the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="4a39e-169">Il diagramma seguente illustra la relazione tra IIS, il modulo ASP.NET Core e un'app ospitata out-of-process:</span><span class="sxs-lookup"><span data-stu-id="4a39e-169">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted out-of-process:</span></span>

![Modulo ASP.NET Core](index/_static/ancm-outofprocess.png)

<span data-ttu-id="4a39e-171">Le richieste arrivano dal Web al driver HTTP.sys in modalità kernel.</span><span class="sxs-lookup"><span data-stu-id="4a39e-171">Requests arrive from the web to the kernel-mode HTTP.sys driver.</span></span> <span data-ttu-id="4a39e-172">Il driver instrada le richieste a IIS sulla porta configurata per il sito Web, in genere 80 (HTTP) o 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="4a39e-172">The driver routes the requests to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span> <span data-ttu-id="4a39e-173">Il modulo inoltra le richieste a Kestrel su una porta casuale per l'app non corrispondente alla porta 80 o 443.</span><span class="sxs-lookup"><span data-stu-id="4a39e-173">The module forwards the requests to Kestrel on a random port for the app, which isn't port 80 or 443.</span></span>

<span data-ttu-id="4a39e-174">Il modulo specifica la porta tramite una variabile di ambiente all'avvio e il [middleware di integrazione IIS](xref:host-and-deploy/iis/index#enable-the-iisintegration-components) configura il server per l'ascolto su `http://localhost:{port}`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-174">The module specifies the port via an environment variable at startup, and the [IIS Integration Middleware](xref:host-and-deploy/iis/index#enable-the-iisintegration-components) configures the server to listen on `http://localhost:{port}`.</span></span> <span data-ttu-id="4a39e-175">Vengono eseguiti controlli aggiuntivi e le richieste che non provengono dal modulo vengono rifiutate.</span><span class="sxs-lookup"><span data-stu-id="4a39e-175">Additional checks are performed, and requests that don't originate from the module are rejected.</span></span> <span data-ttu-id="4a39e-176">Il modulo non supporta l'inoltro HTTPS, pertanto le richieste vengono inoltrate tramite HTTP anche se sono state ricevute da IIS tramite HTTPS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-176">The module doesn't support HTTPS forwarding, so requests are forwarded over HTTP even if received by IIS over HTTPS.</span></span>

<span data-ttu-id="4a39e-177">Dopo che Kestrel ha prelevato la richiesta dal modulo, viene eseguito il push della richiesta nella pipeline middleware ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="4a39e-177">After Kestrel picks up the request from the module, the request is pushed into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="4a39e-178">La pipeline middleware gestisce la richiesta e la passa come istanza di `HttpContext` alla logica dell'app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-178">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="4a39e-179">Il middleware aggiunto dall'integrazione di IIS aggiorna lo schema, l'IP remoto e il percorso di base all'account per l'inoltro della richiesta a Kestrel.</span><span class="sxs-lookup"><span data-stu-id="4a39e-179">Middleware added by IIS Integration updates the scheme, remote IP, and pathbase to account for forwarding the request to Kestrel.</span></span> <span data-ttu-id="4a39e-180">La risposta dell'app viene quindi passata a IIS, che ne esegue di nuovo il push al client HTTP che ha avviato la richiesta.</span><span class="sxs-lookup"><span data-stu-id="4a39e-180">The app's response is passed back to IIS, which pushes it back out to the HTTP client that initiated the request.</span></span>

<span data-ttu-id="4a39e-181">`CreateDefaultBuilder` configura il server [Kestrel](xref:fundamentals/servers/kestrel) come server Web e abilita l'integrazione di IIS configurando il percorso base e la porta per il [modulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="4a39e-181">`CreateDefaultBuilder` configures [Kestrel](xref:fundamentals/servers/kestrel) server as the web server and enables IIS Integration by configuring the base path and port for the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span>

<span data-ttu-id="4a39e-182">Il modulo ASP.NET Core genera una porta dinamica da assegnare al processo back-end.</span><span class="sxs-lookup"><span data-stu-id="4a39e-182">The ASP.NET Core Module generates a dynamic port to assign to the backend process.</span></span> <span data-ttu-id="4a39e-183">`CreateDefaultBuilder` chiama il metodo <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*>.</span><span class="sxs-lookup"><span data-stu-id="4a39e-183">`CreateDefaultBuilder` calls the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> method.</span></span> <span data-ttu-id="4a39e-184">`UseIISIntegration` configura Kestrel per l'ascolto sulla porta dinamica all'indirizzo IP localhost (`127.0.0.1`).</span><span class="sxs-lookup"><span data-stu-id="4a39e-184">`UseIISIntegration` configures Kestrel to listen on the dynamic port at the localhost IP address (`127.0.0.1`).</span></span> <span data-ttu-id="4a39e-185">Se la porta dinamica è 1234, Kestrel è in ascolto su `127.0.0.1:1234`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-185">If the dynamic port is 1234, Kestrel listens at `127.0.0.1:1234`.</span></span> <span data-ttu-id="4a39e-186">Questa configurazione sostituisce le altre configurazioni URL fornite da:</span><span class="sxs-lookup"><span data-stu-id="4a39e-186">This configuration replaces other URL configurations provided by:</span></span>

* `UseUrls`
* [<span data-ttu-id="4a39e-187">API Listen di Kestrel</span><span class="sxs-lookup"><span data-stu-id="4a39e-187">Kestrel's Listen API</span></span>](xref:fundamentals/servers/kestrel#endpoint-configuration)
* <span data-ttu-id="4a39e-188">[Configurazione](xref:fundamentals/configuration/index) (o [opzione URL della riga di comando](xref:fundamentals/host/web-host#override-configuration))</span><span class="sxs-lookup"><span data-stu-id="4a39e-188">[Configuration](xref:fundamentals/configuration/index) (or [command-line --urls option](xref:fundamentals/host/web-host#override-configuration))</span></span>

<span data-ttu-id="4a39e-189">Le chiamate a `UseUrls` o all'API `Listen` di Kestrel non sono necessarie quando si usa il modulo.</span><span class="sxs-lookup"><span data-stu-id="4a39e-189">Calls to `UseUrls` or Kestrel's `Listen` API aren't required when using the module.</span></span> <span data-ttu-id="4a39e-190">In caso di chiamata di `UseUrls` o `Listen`, Kestrel resta in ascolto sulla porta specificata solo quando si esegue l'app senza IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-190">If `UseUrls` or `Listen` is called, Kestrel listens on the port specified only when running the app without IIS.</span></span>

<span data-ttu-id="4a39e-191">Per altre informazioni sui modelli di hosting in-process e out-of-process, vedere [Modulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module) e [Guida di riferimento per la configurazione del modulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="4a39e-191">For more information on the in-process and out-of-process hosting models, see [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) and [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module).</span></span>

::: moniker-end

<span data-ttu-id="4a39e-192">Per indicazioni sulla configurazione del modulo ASP.NET Core, vedere <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="4a39e-192">For ASP.NET Core Module configuration guidance, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

<span data-ttu-id="4a39e-193">Per altre informazioni sull'hosting, vedere [Hosting in ASP.NET Core](xref:fundamentals/index#host).</span><span class="sxs-lookup"><span data-stu-id="4a39e-193">For more information on hosting, see [Host in ASP.NET Core](xref:fundamentals/index#host).</span></span>

## <a name="application-configuration"></a><span data-ttu-id="4a39e-194">Configurazione dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="4a39e-194">Application configuration</span></span>

### <a name="enable-the-iisintegration-components"></a><span data-ttu-id="4a39e-195">Abilitare i componenti IISIntegration</span><span class="sxs-lookup"><span data-stu-id="4a39e-195">Enable the IISIntegration components</span></span>

<span data-ttu-id="4a39e-196">Un file *Program.cs* tipico chiama <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder*> per avviare la configurazione di un host che consenta l'integrazione con IIS:</span><span class="sxs-lookup"><span data-stu-id="4a39e-196">A typical *Program.cs* calls <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder*> to begin setting up a host that enables integration with IIS:</span></span>

```csharp
public static IWebHostBuilder CreateWebHostBuilder(string[] args) =>
    WebHost.CreateDefaultBuilder(args)
        ...
```

### <a name="iis-options"></a><span data-ttu-id="4a39e-197">Opzioni IIS</span><span class="sxs-lookup"><span data-stu-id="4a39e-197">IIS options</span></span>

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="4a39e-198">**Modello di hosting in-process**</span><span class="sxs-lookup"><span data-stu-id="4a39e-198">**In-process hosting model**</span></span>

<span data-ttu-id="4a39e-199">Per configurare le opzioni del server IIS includere una configurazione del servizio per <xref:Microsoft.AspNetCore.Builder.IISServerOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span><span class="sxs-lookup"><span data-stu-id="4a39e-199">To configure IIS Server options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISServerOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span></span> <span data-ttu-id="4a39e-200">L'esempio seguente disabilita AutomaticAuthentication:</span><span class="sxs-lookup"><span data-stu-id="4a39e-200">The following example disables AutomaticAuthentication:</span></span>

```csharp
services.Configure<IISServerOptions>(options => 
{
    options.AutomaticAuthentication = false;
});
```

::: moniker-end

::: moniker range=">= aspnetcore-3.0"

| <span data-ttu-id="4a39e-201">Opzione</span><span class="sxs-lookup"><span data-stu-id="4a39e-201">Option</span></span>                         | <span data-ttu-id="4a39e-202">Impostazione predefinita</span><span class="sxs-lookup"><span data-stu-id="4a39e-202">Default</span></span> | <span data-ttu-id="4a39e-203">Impostazioni</span><span class="sxs-lookup"><span data-stu-id="4a39e-203">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="4a39e-204">Se `true`, IIS Server imposta l'utente `HttpContext.User` autenticato tramite l'[autenticazione di Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="4a39e-204">If `true`, IIS Server sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="4a39e-205">Se `false`, il server fornisce solo un'identità per `HttpContext.User` e risponde alle richieste esplicite di `AuthenticationScheme`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-205">If `false`, the server only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="4a39e-206">Per il funzionamento di `AutomaticAuthentication` l’autenticazione di Windows deve essere abilitata in IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-206">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="4a39e-207">Per altre informazioni, vedere [Autenticazione di Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="4a39e-207">For more information, see [Windows Authentication](xref:security/authentication/windowsauth).</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="4a39e-208">Imposta il nome visualizzato dagli utenti nelle pagine di accesso.</span><span class="sxs-lookup"><span data-stu-id="4a39e-208">Sets the display name shown to users on login pages.</span></span> |
| `AllowSynchronousIO`           | `false` | <span data-ttu-id="4a39e-209">Indica se l'I/O sincrono è consentito per `HttpContext.Request` e `HttpContext.Response`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-209">Whether synchronous IO is allowed for the `HttpContext.Request` and the `HttpContext.Response`.</span></span> |
| `MaxRequestBodySize`           | `30000000`  | <span data-ttu-id="4a39e-210">Ottiene o imposta la dimensione massima del corpo della richiesta per `HttpRequest`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-210">Gets or sets the max request body size for the `HttpRequest`.</span></span> <span data-ttu-id="4a39e-211">Notare che IIS stesso include il limite `maxAllowedContentLength`, che verrà elaborato prima del set `MaxRequestBodySize` in `IISServerOptions`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-211">Note that IIS itself has the limit `maxAllowedContentLength` which will be processed before the `MaxRequestBodySize` set in the `IISServerOptions`.</span></span> <span data-ttu-id="4a39e-212">La modifica di `MaxRequestBodySize` non influisce su `maxAllowedContentLength`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-212">Changing the `MaxRequestBodySize` won't affect the `maxAllowedContentLength`.</span></span> <span data-ttu-id="4a39e-213">Per aumentare `maxAllowedContentLength`, aggiungere una voce in *web.config* per impostare `maxAllowedContentLength` su un valore superiore.</span><span class="sxs-lookup"><span data-stu-id="4a39e-213">To increase `maxAllowedContentLength`, add an entry in the *web.config* to set `maxAllowedContentLength` to a higher value.</span></span> <span data-ttu-id="4a39e-214">Per ulteriori informazioni, vedere [Configurazione](/iis/configuration/system.webServer/security/requestFiltering/requestLimits/#configuration).</span><span class="sxs-lookup"><span data-stu-id="4a39e-214">For more details, see [Configuration](/iis/configuration/system.webServer/security/requestFiltering/requestLimits/#configuration).</span></span> |

<span data-ttu-id="4a39e-215">**Modello di hosting out-of-process**</span><span class="sxs-lookup"><span data-stu-id="4a39e-215">**Out-of-process hosting model**</span></span>

::: moniker-end

::: moniker range="< aspnetcore-3.0"

| <span data-ttu-id="4a39e-216">Opzione</span><span class="sxs-lookup"><span data-stu-id="4a39e-216">Option</span></span>                         | <span data-ttu-id="4a39e-217">Impostazione predefinita</span><span class="sxs-lookup"><span data-stu-id="4a39e-217">Default</span></span> | <span data-ttu-id="4a39e-218">Impostazioni</span><span class="sxs-lookup"><span data-stu-id="4a39e-218">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="4a39e-219">Se `true`, IIS Server imposta l'utente `HttpContext.User` autenticato tramite l'[autenticazione di Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="4a39e-219">If `true`, IIS Server sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="4a39e-220">Se `false`, il server fornisce solo un'identità per `HttpContext.User` e risponde alle richieste esplicite di `AuthenticationScheme`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-220">If `false`, the server only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="4a39e-221">Per il funzionamento di `AutomaticAuthentication` l’autenticazione di Windows deve essere abilitata in IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-221">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="4a39e-222">Per altre informazioni, vedere [Autenticazione di Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="4a39e-222">For more information, see [Windows Authentication](xref:security/authentication/windowsauth).</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="4a39e-223">Imposta il nome visualizzato dagli utenti nelle pagine di accesso.</span><span class="sxs-lookup"><span data-stu-id="4a39e-223">Sets the display name shown to users on login pages.</span></span> |

::: moniker-end

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="4a39e-224">**Modello di hosting out-of-process**</span><span class="sxs-lookup"><span data-stu-id="4a39e-224">**Out-of-process hosting model**</span></span>

::: moniker-end

<span data-ttu-id="4a39e-225">Per configurare le opzioni di IIS includere una configurazione del servizio per <xref:Microsoft.AspNetCore.Builder.IISOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span><span class="sxs-lookup"><span data-stu-id="4a39e-225">To configure IIS options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span></span> <span data-ttu-id="4a39e-226">Nell'esempio seguente si impedisce all'app di popolare `HttpContext.Connection.ClientCertificate`:</span><span class="sxs-lookup"><span data-stu-id="4a39e-226">The following example prevents the app from populating `HttpContext.Connection.ClientCertificate`:</span></span>

```csharp
services.Configure<IISOptions>(options => 
{
    options.ForwardClientCertificate = false;
});
```

| <span data-ttu-id="4a39e-227">Opzione</span><span class="sxs-lookup"><span data-stu-id="4a39e-227">Option</span></span>                         | <span data-ttu-id="4a39e-228">Impostazione predefinita</span><span class="sxs-lookup"><span data-stu-id="4a39e-228">Default</span></span> | <span data-ttu-id="4a39e-229">Impostazioni</span><span class="sxs-lookup"><span data-stu-id="4a39e-229">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="4a39e-230">Se `true`, il [middleware di integrazione IIS](#enable-the-iisintegration-components) imposta `HttpContext.User` autenticato tramite l'[autenticazione di Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="4a39e-230">If `true`, [IIS Integration Middleware](#enable-the-iisintegration-components) sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="4a39e-231">Se `false`, il middleware fornisce solo un'identità per `HttpContext.User` e risponde solo alle richieste esplicite di `AuthenticationScheme`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-231">If `false`, the middleware only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="4a39e-232">Per il funzionamento di `AutomaticAuthentication` l’autenticazione di Windows deve essere abilitata in IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-232">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="4a39e-233">Per altre informazioni, vedere l'argomento [Autenticazione di Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="4a39e-233">For more information, see the [Windows Authentication](xref:security/authentication/windowsauth) topic.</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="4a39e-234">Imposta il nome visualizzato dagli utenti nelle pagine di accesso.</span><span class="sxs-lookup"><span data-stu-id="4a39e-234">Sets the display name shown to users on login pages.</span></span> |
| `ForwardClientCertificate`     | `true`  | <span data-ttu-id="4a39e-235">Se è `true` ed è presente l’intestazione della richiesta `MS-ASPNETCORE-CLIENTCERT`, `HttpContext.Connection.ClientCertificate` viene popolato.</span><span class="sxs-lookup"><span data-stu-id="4a39e-235">If `true` and the `MS-ASPNETCORE-CLIENTCERT` request header is present, the `HttpContext.Connection.ClientCertificate` is populated.</span></span> |

### <a name="proxy-server-and-load-balancer-scenarios"></a><span data-ttu-id="4a39e-236">Scenari con server proxy e servizi di bilanciamento del carico</span><span class="sxs-lookup"><span data-stu-id="4a39e-236">Proxy server and load balancer scenarios</span></span>

<span data-ttu-id="4a39e-237">Il [middleware di integrazione IIS](#enable-the-iisintegration-components), che consente di configurare il middleware delle intestazioni inoltrate, e il modulo ASP.NET Core sono configurati per inoltrare lo schema (HTTP/HTTPS) e l'indirizzo IP remoto di origine della richiesta.</span><span class="sxs-lookup"><span data-stu-id="4a39e-237">The [IIS Integration Middleware](#enable-the-iisintegration-components), which configures Forwarded Headers Middleware, and the ASP.NET Core Module are configured to forward the scheme (HTTP/HTTPS) and the remote IP address where the request originated.</span></span> <span data-ttu-id="4a39e-238">Potrebbero essere necessari interventi di configurazione aggiuntivi per le app ospitate dietro ulteriori server proxy e servizi di bilanciamento del carico.</span><span class="sxs-lookup"><span data-stu-id="4a39e-238">Additional configuration might be required for apps hosted behind additional proxy servers and load balancers.</span></span> <span data-ttu-id="4a39e-239">Per altre informazioni, vedere [Configurare ASP.NET Core per l'utilizzo di server proxy e servizi di bilanciamento del carico](xref:host-and-deploy/proxy-load-balancer).</span><span class="sxs-lookup"><span data-stu-id="4a39e-239">For more information, see [Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span></span>

### <a name="webconfig-file"></a><span data-ttu-id="4a39e-240">File web.config</span><span class="sxs-lookup"><span data-stu-id="4a39e-240">web.config file</span></span>

<span data-ttu-id="4a39e-241">Il file *web.config* configura il [modulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="4a39e-241">The *web.config* file configures the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="4a39e-242">La creazione, la trasformazione e la pubblicazione del file *web.config* sono operazioni gestite da una destinazione MSBuild (`_TransformWebConfig`) quando viene pubblicato il progetto.</span><span class="sxs-lookup"><span data-stu-id="4a39e-242">Creating, transforming, and publishing the *web.config* file is handled by an MSBuild target (`_TransformWebConfig`) when the project is published.</span></span> <span data-ttu-id="4a39e-243">Questa destinazione si trova tra le destinazioni Web SDK (`Microsoft.NET.Sdk.Web`).</span><span class="sxs-lookup"><span data-stu-id="4a39e-243">This target is present in the Web SDK targets (`Microsoft.NET.Sdk.Web`).</span></span> <span data-ttu-id="4a39e-244">L'SDK è impostato all'inizio del file di progetto:</span><span class="sxs-lookup"><span data-stu-id="4a39e-244">The SDK is set at the top of the project file:</span></span>

```xml
<Project Sdk="Microsoft.NET.Sdk.Web">
```

<span data-ttu-id="4a39e-245">Se nel progetto non è presente un file *web.config*, il file viene creato con un valore *processPath* e *argomenti* corretti per la configurazione del [modulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module). Il file viene quindi spostato nell'[output pubblicato](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="4a39e-245">If a *web.config* file isn't present in the project, the file is created with the correct *processPath* and *arguments* to configure the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) and moved to [published output](xref:host-and-deploy/directory-structure).</span></span>

<span data-ttu-id="4a39e-246">Se nel progetto è presente un file *web.config*, il file viene trasformato con il valore di *processPath* e gli *argomenti* corretti per la configurazione del modulo ASP.NET Core, quindi viene spostato nell'output pubblicato.</span><span class="sxs-lookup"><span data-stu-id="4a39e-246">If a *web.config* file is present in the project, the file is transformed with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to published output.</span></span> <span data-ttu-id="4a39e-247">La trasformazione non modifica le impostazioni di configurazione di IIS incluse nel file.</span><span class="sxs-lookup"><span data-stu-id="4a39e-247">The transformation doesn't modify IIS configuration settings in the file.</span></span>

<span data-ttu-id="4a39e-248">Il file *web.config* può fornire ulteriori impostazioni di configurazione di IIS che controllano i moduli IIS attivi.</span><span class="sxs-lookup"><span data-stu-id="4a39e-248">The *web.config* file may provide additional IIS configuration settings that control active IIS modules.</span></span> <span data-ttu-id="4a39e-249">Per informazioni sui moduli IIS in grado di elaborare le richieste con le app di ASP.NET Core, vedere l'argomento [Moduli IIS](xref:host-and-deploy/iis/modules).</span><span class="sxs-lookup"><span data-stu-id="4a39e-249">For information on IIS modules that are capable of processing requests with ASP.NET Core apps, see the [IIS modules](xref:host-and-deploy/iis/modules) topic.</span></span>

<span data-ttu-id="4a39e-250">Per impedire che Web SDK trasformi il file *web.config*, usare la proprietà **\<IsTransformWebConfigDisabled >** nel file di progetto:</span><span class="sxs-lookup"><span data-stu-id="4a39e-250">To prevent the Web SDK from transforming the *web.config* file, use the **\<IsTransformWebConfigDisabled>** property in the project file:</span></span>

```xml
<PropertyGroup>
  <IsTransformWebConfigDisabled>true</IsTransformWebConfigDisabled>
</PropertyGroup>
```

<span data-ttu-id="4a39e-251">Quando si disabilita la trasformazione del file in Web SDK, il valore di *processPath* e gli *argomenti* devono essere impostati manualmente dallo sviluppatore.</span><span class="sxs-lookup"><span data-stu-id="4a39e-251">When disabling the Web SDK from transforming the file, the *processPath* and *arguments* should be manually set by the developer.</span></span> <span data-ttu-id="4a39e-252">Per altre informazioni, vedere la [Guida di riferimento per la configurazione del modulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="4a39e-252">For more information, see the [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module).</span></span>

### <a name="webconfig-file-location"></a><span data-ttu-id="4a39e-253">Posizione del file web.config</span><span class="sxs-lookup"><span data-stu-id="4a39e-253">web.config file location</span></span>

<span data-ttu-id="4a39e-254">Per configurare correttamente il [modulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module) , il file *Web. config* deve essere presente nel percorso [radice del contenuto](xref:fundamentals/index#content-root) (in genere il percorso di base dell'app) dell'app distribuita.</span><span class="sxs-lookup"><span data-stu-id="4a39e-254">In order to set up the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) correctly, the *web.config* file must be present at the [content root](xref:fundamentals/index#content-root) path (typically the app base path) of the deployed app.</span></span> <span data-ttu-id="4a39e-255">Corrisponde al percorso fisico del sito Web fornito a IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-255">This is the same location as the website physical path provided to IIS.</span></span> <span data-ttu-id="4a39e-256">Il file *web.config* deve essere presente nella radice dell'app per abilitare la pubblicazione di più app mediante Distribuzione Web.</span><span class="sxs-lookup"><span data-stu-id="4a39e-256">The *web.config* file is required at the root of the app to enable the publishing of multiple apps using Web Deploy.</span></span>

<span data-ttu-id="4a39e-257">Nel percorso fisico dell'app sono presenti file riservati, come *\<assembly>.runtimeconfig.json*, *\<assembly>.xml* (commenti in formato documentazione XML) e *\<assembly>.deps.json*.</span><span class="sxs-lookup"><span data-stu-id="4a39e-257">Sensitive files exist on the app's physical path, such as *\<assembly>.runtimeconfig.json*, *\<assembly>.xml* (XML Documentation comments), and *\<assembly>.deps.json*.</span></span> <span data-ttu-id="4a39e-258">Quando il file *web.config* è presente e il sito viene avviato normalmente, IIS non rende disponibili questi file riservati se vengono richiesti.</span><span class="sxs-lookup"><span data-stu-id="4a39e-258">When the *web.config* file is present and the site starts normally, IIS doesn't serve these sensitive files if they're requested.</span></span> <span data-ttu-id="4a39e-259">Se il file *web.config* non è presente, ha un nome non corretto o non è in grado di configurare il sito per l'avvio normale, IIS potrebbe rendere disponibili pubblicamente i file riservati.</span><span class="sxs-lookup"><span data-stu-id="4a39e-259">If the *web.config* file is missing, incorrectly named, or unable to configure the site for normal startup, IIS may serve sensitive files publicly.</span></span>

<span data-ttu-id="4a39e-260">**Il file *Web. config* deve essere sempre presente nella distribuzione, denominato correttamente e in grado di configurare il sito per l'avvio normale. Non rimuovere mai il file *Web. config* da una distribuzione di produzione.**</span><span class="sxs-lookup"><span data-stu-id="4a39e-260">**The *web.config* file must be present in the deployment at all times, correctly named, and able to configure the site for normal start up. Never remove the *web.config* file from a production deployment.**</span></span>

### <a name="transform-webconfig"></a><span data-ttu-id="4a39e-261">Trasformare web.config</span><span class="sxs-lookup"><span data-stu-id="4a39e-261">Transform web.config</span></span>

<span data-ttu-id="4a39e-262">Se è necessario trasformare *web.config* in fase di pubblicazione (ad esempio, impostare variabili di ambiente in base a configurazione, profilo o ambiente), vedere <xref:host-and-deploy/iis/transform-webconfig>.</span><span class="sxs-lookup"><span data-stu-id="4a39e-262">If you need to transform *web.config* on publish (for example, set environment variables based on the configuration, profile, or environment), see <xref:host-and-deploy/iis/transform-webconfig>.</span></span>

## <a name="iis-configuration"></a><span data-ttu-id="4a39e-263">Configurazione di IIS</span><span class="sxs-lookup"><span data-stu-id="4a39e-263">IIS configuration</span></span>

<span data-ttu-id="4a39e-264">**Sistemi operativi Windows Server**</span><span class="sxs-lookup"><span data-stu-id="4a39e-264">**Windows Server operating systems**</span></span>

<span data-ttu-id="4a39e-265">Abilitare il ruolo del server **Server Web (IIS)** e stabilire i servizi di ruolo.</span><span class="sxs-lookup"><span data-stu-id="4a39e-265">Enable the **Web Server (IIS)** server role and establish role services.</span></span>

1. <span data-ttu-id="4a39e-266">Usare la procedura guidata **Aggiungi ruoli e funzionalità** accessibile tramite il menu **Gestisci** o il collegamento in **Server Manager**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-266">Use the **Add Roles and Features** wizard from the **Manage** menu or the link in **Server Manager**.</span></span> <span data-ttu-id="4a39e-267">Nel passaggio **Ruoli del server** selezionare la casella per **Server Web (IIS)** .</span><span class="sxs-lookup"><span data-stu-id="4a39e-267">On the **Server Roles** step, check the box for **Web Server (IIS)**.</span></span>

   ![Il ruolo Server Web IIS viene selezionato nel passaggio dei ruoli del server Selezionare.](index/_static/server-roles-ws2016.png)

1. <span data-ttu-id="4a39e-269">Dopo il passaggio **Funzionalità**, viene caricato il passaggio**Servizi ruolo** per Server Web (IIS).</span><span class="sxs-lookup"><span data-stu-id="4a39e-269">After the **Features** step, the **Role services** step loads for Web Server (IIS).</span></span> <span data-ttu-id="4a39e-270">Selezionare i servizi ruolo IIS desiderati o accettare i servizi ruolo predefiniti specificati.</span><span class="sxs-lookup"><span data-stu-id="4a39e-270">Select the IIS role services desired or accept the default role services provided.</span></span>

   ![I servizi ruolo predefiniti vengono selezionati nel passaggio Selezionare i servizi ruolo.](index/_static/role-services-ws2016.png)

   <span data-ttu-id="4a39e-272">**Autenticazione di Windows (facoltativa)**</span><span class="sxs-lookup"><span data-stu-id="4a39e-272">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="4a39e-273">Per abilitare l'autenticazione di Windows, espandere i nodi seguenti: **Server Web** > **Sicurezza**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-273">To enable Windows Authentication, expand the following nodes: **Web Server** > **Security**.</span></span> <span data-ttu-id="4a39e-274">Selezionare la funzionalità **Autenticazione di Windows**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-274">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="4a39e-275">Per altre informazioni, vedere [Autenticazione di Windows\<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) e [Configurare l'autenticazione Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="4a39e-275">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="4a39e-276">**WebSockets (facoltativo)**</span><span class="sxs-lookup"><span data-stu-id="4a39e-276">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="4a39e-277">WebSockets è supportato con ASP.NET Core 1.1 o versioni successive.</span><span class="sxs-lookup"><span data-stu-id="4a39e-277">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="4a39e-278">Per abilitare WebSockets, espandere i nodi seguenti: **Server Web** > **Sviluppo di applicazioni**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-278">To enable WebSockets, expand the following nodes: **Web Server** > **Application Development**.</span></span> <span data-ttu-id="4a39e-279">Selezionare la funzionalità **Protocollo WebSocket**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-279">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="4a39e-280">Per altre informazioni, vedere [Oggetti WebSocket](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="4a39e-280">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="4a39e-281">Procedere con il passaggio **Conferma** per installare il ruolo del server web e i servizi.</span><span class="sxs-lookup"><span data-stu-id="4a39e-281">Proceed through the **Confirmation** step to install the web server role and services.</span></span> <span data-ttu-id="4a39e-282">Dopo l'installazione del ruolo **Server Web (IIS)** non è necessario riavviare il server o IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-282">A server/IIS restart isn't required after installing the **Web Server (IIS)** role.</span></span>

<span data-ttu-id="4a39e-283">**Sistemi operativi desktop di Windows**</span><span class="sxs-lookup"><span data-stu-id="4a39e-283">**Windows desktop operating systems**</span></span>

<span data-ttu-id="4a39e-284">Abilitare **Console di gestione IIS** e **Servizi Web**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-284">Enable the **IIS Management Console** and **World Wide Web Services**.</span></span>

1. <span data-ttu-id="4a39e-285">Passare a **Pannello di controllo** > **Programmi** > **Programmi e funzionalità** > **Attiva o disattiva funzionalità di Windows** (sul lato sinistro dello schermo).</span><span class="sxs-lookup"><span data-stu-id="4a39e-285">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>

1. <span data-ttu-id="4a39e-286">Aprire il nodo **Internet Information Services**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-286">Open the **Internet Information Services** node.</span></span> <span data-ttu-id="4a39e-287">Aprire il nodo **Strumenti di gestione Web**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-287">Open the **Web Management Tools** node.</span></span>

1. <span data-ttu-id="4a39e-288">Selezionare la casella per **Console di gestione IIS**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-288">Check the box for **IIS Management Console**.</span></span>

1. <span data-ttu-id="4a39e-289">Selezionare la casella per **Servizi World Wide Web**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-289">Check the box for **World Wide Web Services**.</span></span>

1. <span data-ttu-id="4a39e-290">Accettare le funzionalità predefinite per **Servizi World Wide Web** o personalizzare le funzionalità IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-290">Accept the default features for **World Wide Web Services** or customize the IIS features.</span></span>

   <span data-ttu-id="4a39e-291">**Autenticazione di Windows (facoltativa)**</span><span class="sxs-lookup"><span data-stu-id="4a39e-291">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="4a39e-292">Per abilitare l'autenticazione di Windows, espandere i nodi seguenti: **Servizi Web** > **Sicurezza**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-292">To enable Windows Authentication, expand the following nodes: **World Wide Web Services** > **Security**.</span></span> <span data-ttu-id="4a39e-293">Selezionare la funzionalità **Autenticazione di Windows**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-293">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="4a39e-294">Per altre informazioni, vedere [Autenticazione di Windows\<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) e [Configurare l'autenticazione Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="4a39e-294">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="4a39e-295">**WebSockets (facoltativo)**</span><span class="sxs-lookup"><span data-stu-id="4a39e-295">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="4a39e-296">WebSockets è supportato con ASP.NET Core 1.1 o versioni successive.</span><span class="sxs-lookup"><span data-stu-id="4a39e-296">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="4a39e-297">Per abilitare WebSockets, espandere i nodi seguenti: **Servizi Web** > **Funzionalità per lo sviluppo di applicazioni**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-297">To enable WebSockets, expand the following nodes: **World Wide Web Services** > **Application Development Features**.</span></span> <span data-ttu-id="4a39e-298">Selezionare la funzionalità **Protocollo WebSocket**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-298">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="4a39e-299">Per altre informazioni, vedere [Oggetti WebSocket](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="4a39e-299">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="4a39e-300">Se l'installazione di IIS richiede un riavvio, riavviare il sistema.</span><span class="sxs-lookup"><span data-stu-id="4a39e-300">If the IIS installation requires a restart, restart the system.</span></span>

![La console di gestione IIS e servizi World Wide Web sono selezionati nelle funzionalità di Windows.](index/_static/windows-features-win10.png)

## <a name="install-the-net-core-hosting-bundle"></a><span data-ttu-id="4a39e-302">Installare il bundle di hosting .NET Core</span><span class="sxs-lookup"><span data-stu-id="4a39e-302">Install the .NET Core Hosting Bundle</span></span>

<span data-ttu-id="4a39e-303">Installare il *bundle di hosting .NET Core* nel sistema di hosting.</span><span class="sxs-lookup"><span data-stu-id="4a39e-303">Install the *.NET Core Hosting Bundle* on the hosting system.</span></span> <span data-ttu-id="4a39e-304">L'aggregazione installa il runtime di .NET Core, la libreria di .NET Core e il [modulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="4a39e-304">The bundle installs the .NET Core Runtime, .NET Core Library, and the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="4a39e-305">Il modulo consente l'esecuzione delle app ASP.NET Core dietro IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-305">The module allows ASP.NET Core apps to run behind IIS.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4a39e-306">Se il bundle di hosting viene installato prima di IIS, è necessario riparare l'installazione del bundle.</span><span class="sxs-lookup"><span data-stu-id="4a39e-306">If the Hosting Bundle is installed before IIS, the bundle installation must be repaired.</span></span> <span data-ttu-id="4a39e-307">Eseguire di nuovo il programma di installazione del bundle di hosting dopo l'installazione di IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-307">Run the Hosting Bundle installer again after installing IIS.</span></span>
>
> <span data-ttu-id="4a39e-308">Se il bundle di hosting viene installato dopo l'installazione della versione a 64 bit (x64) di .NET Core, uno o più SDK potrebbero risultare mancanti ([Non sono stati rilevati .NET Core SDK](xref:test/troubleshoot#no-net-core-sdks-were-detected)).</span><span class="sxs-lookup"><span data-stu-id="4a39e-308">If the Hosting Bundle is installed after installing the 64-bit (x64) version of .NET Core, SDKs might appear to be missing ([No .NET Core SDKs were detected](xref:test/troubleshoot#no-net-core-sdks-were-detected)).</span></span> <span data-ttu-id="4a39e-309">Per risolvere il problema, vedere <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle>.</span><span class="sxs-lookup"><span data-stu-id="4a39e-309">To resolve the problem, see <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle>.</span></span>

### <a name="direct-download-current-version"></a><span data-ttu-id="4a39e-310">Download diretto (versione corrente)</span><span class="sxs-lookup"><span data-stu-id="4a39e-310">Direct download (current version)</span></span>

<span data-ttu-id="4a39e-311">Scaricare il programma di installazione mediante il collegamento seguente:</span><span class="sxs-lookup"><span data-stu-id="4a39e-311">Download the installer using the following link:</span></span>

[<span data-ttu-id="4a39e-312">Programma di installazione del bundle di hosting .NET Core corrente (download diretto)</span><span class="sxs-lookup"><span data-stu-id="4a39e-312">Current .NET Core Hosting Bundle installer (direct download)</span></span>](https://www.microsoft.com/net/permalink/dotnetcore-current-windows-runtime-bundle-installer)

### <a name="earlier-versions-of-the-installer"></a><span data-ttu-id="4a39e-313">Versioni precedenti del programma di installazione</span><span class="sxs-lookup"><span data-stu-id="4a39e-313">Earlier versions of the installer</span></span>

<span data-ttu-id="4a39e-314">Per ottenere una versione precedente del programma di installazione:</span><span class="sxs-lookup"><span data-stu-id="4a39e-314">To obtain an earlier version of the installer:</span></span>

1. <span data-ttu-id="4a39e-315">Passare agli [archivi dei download per .NET](https://www.microsoft.com/net/download/archives).</span><span class="sxs-lookup"><span data-stu-id="4a39e-315">Navigate to the [.NET download archives](https://www.microsoft.com/net/download/archives).</span></span>
1. <span data-ttu-id="4a39e-316">In **.NET Core**, selezionare la versione di .NET Core.</span><span class="sxs-lookup"><span data-stu-id="4a39e-316">Under **.NET Core**, select the .NET Core version.</span></span>
1. <span data-ttu-id="4a39e-317">Nella colonna **Run apps - Runtime** (App di esecuzione - Runtime), trovare la riga della versione di runtime di .NET Core desiderata.</span><span class="sxs-lookup"><span data-stu-id="4a39e-317">In the **Run apps - Runtime** column, find the row of the .NET Core runtime version desired.</span></span>
1. <span data-ttu-id="4a39e-318">Scaricare il programma di installazione tramite il collegamento **Runtime & Hosting Bundle** (Runtime e bundle di hosting).</span><span class="sxs-lookup"><span data-stu-id="4a39e-318">Download the installer using the **Runtime & Hosting Bundle** link.</span></span>

> [!WARNING]
> <span data-ttu-id="4a39e-319">Alcuni programmi di installazione contengono versioni che hanno terminato il loro ciclo di vita e non sono più supportate da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="4a39e-319">Some installers contain release versions that have reached their end of life (EOL) and are no longer supported by Microsoft.</span></span> <span data-ttu-id="4a39e-320">Per altre informazioni, vedere i [criteri di supporto](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span><span class="sxs-lookup"><span data-stu-id="4a39e-320">For more information, see the [support policy](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span></span>

### <a name="install-the-hosting-bundle"></a><span data-ttu-id="4a39e-321">Installare il bundle di hosting</span><span class="sxs-lookup"><span data-stu-id="4a39e-321">Install the Hosting Bundle</span></span>

1. <span data-ttu-id="4a39e-322">Eseguire il programma di installazione nel server.</span><span class="sxs-lookup"><span data-stu-id="4a39e-322">Run the installer on the server.</span></span> <span data-ttu-id="4a39e-323">Quando si esegue il programma di installazione da una shell dei comandi di amministratore sono disponibili i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="4a39e-323">The following parameters are available when running the installer from an administrator command shell:</span></span>

   * <span data-ttu-id="4a39e-324">`OPT_NO_ANCM=1` &ndash; Ignora l'installazione del modulo ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="4a39e-324">`OPT_NO_ANCM=1` &ndash; Skip installing the ASP.NET Core Module.</span></span>
   * <span data-ttu-id="4a39e-325">`OPT_NO_RUNTIME=1` &ndash; Ignora l'installazione del runtime .NET Core.</span><span class="sxs-lookup"><span data-stu-id="4a39e-325">`OPT_NO_RUNTIME=1` &ndash; Skip installing the .NET Core runtime.</span></span>
   * <span data-ttu-id="4a39e-326">`OPT_NO_SHAREDFX=1` &ndash; Ignora l'installazione del framework condiviso di ASP.NET (runtime ASP.NET).</span><span class="sxs-lookup"><span data-stu-id="4a39e-326">`OPT_NO_SHAREDFX=1` &ndash; Skip installing the ASP.NET Shared Framework (ASP.NET runtime).</span></span>
   * <span data-ttu-id="4a39e-327">`OPT_NO_X86=1` &ndash; Ignora l'installazione dei runtime x86.</span><span class="sxs-lookup"><span data-stu-id="4a39e-327">`OPT_NO_X86=1` &ndash; Skip installing x86 runtimes.</span></span> <span data-ttu-id="4a39e-328">Usare questo parametro se si è certi che non verrà eseguito l'hosting di app a 32 bit.</span><span class="sxs-lookup"><span data-stu-id="4a39e-328">Use this parameter when you know that you won't be hosting 32-bit apps.</span></span> <span data-ttu-id="4a39e-329">Se non esiste alcuna possibilità che in futuro venga eseguito l'hosting di app sia a 32 che a 64 bit, non usare questo parametro e installare entrambi i runtime.</span><span class="sxs-lookup"><span data-stu-id="4a39e-329">If there's any chance that you will host both 32-bit and 64-bit apps in the future, don't use this parameter and install both runtimes.</span></span>
   * <span data-ttu-id="4a39e-330">`OPT_NO_SHARED_CONFIG_CHECK=1` &ndash; Disabilitare il controllo dell'uso di una configurazione condivisa di IIS quando la configurazione condivisa (*applicationHost.config*) è nello stesso computer dell'installazione di IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-330">`OPT_NO_SHARED_CONFIG_CHECK=1` &ndash; Disable the check for using an IIS Shared Configuration when the shared configuration (*applicationHost.config*) is on the same machine as the IIS installation.</span></span> <span data-ttu-id="4a39e-331">*Disponibile solo per i programmi di installazione di bundler di hosting ASP.NET Core 2.2 o versioni successive.*</span><span class="sxs-lookup"><span data-stu-id="4a39e-331">*Only available for ASP.NET Core 2.2 or later Hosting Bundler installers.*</span></span> <span data-ttu-id="4a39e-332">Per ulteriori informazioni, vedere <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span><span class="sxs-lookup"><span data-stu-id="4a39e-332">For more information, see <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span></span>
1. <span data-ttu-id="4a39e-333">Riavviare il sistema o eseguire **net stop was /y** seguito da **net start w3svc** da una shell dei comandi.</span><span class="sxs-lookup"><span data-stu-id="4a39e-333">Restart the system or execute **net stop was /y**, followed by **net start w3svc** from a command shell.</span></span> <span data-ttu-id="4a39e-334">Il riavvio di IIS rileva una modifica alla variabile di ambiente di sistema PATH apportata dal programma di installazione.</span><span class="sxs-lookup"><span data-stu-id="4a39e-334">Restarting IIS picks up a change to the system PATH, which is an environment variable, made by the installer.</span></span>

> [!NOTE]
> <span data-ttu-id="4a39e-335">Per informazioni sulla configurazione condivisa di IIS, vedere [Modulo di ASP.NET Core con configurazione condivisa di IIS](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span><span class="sxs-lookup"><span data-stu-id="4a39e-335">For information on IIS Shared Configuration, see [ASP.NET Core Module with IIS Shared Configuration](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span></span>

## <a name="install-web-deploy-when-publishing-with-visual-studio"></a><span data-ttu-id="4a39e-336">Installare la Distribuzione Web quando si pubblica con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="4a39e-336">Install Web Deploy when publishing with Visual Studio</span></span>

<span data-ttu-id="4a39e-337">Quando si distribuiscono app ai server con [Distribuzione Web](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later), installare la versione più recente di Distribuzione Web nel server.</span><span class="sxs-lookup"><span data-stu-id="4a39e-337">When deploying apps to servers with [Web Deploy](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later), install the latest version of Web Deploy on the server.</span></span> <span data-ttu-id="4a39e-338">Per installare Distribuzione Web usare l'[Installazione guidata piattaforma Web (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) o ottenere direttamente un programma di installazione in [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=43717).</span><span class="sxs-lookup"><span data-stu-id="4a39e-338">To install Web Deploy, use the [Web Platform Installer (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) or obtain an installer directly from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=43717).</span></span> <span data-ttu-id="4a39e-339">Il metodo preferito consiste nell'usare WebPI.</span><span class="sxs-lookup"><span data-stu-id="4a39e-339">The preferred method is to use WebPI.</span></span> <span data-ttu-id="4a39e-340">WebPI offre un'installazione autonoma e una configurazione per i provider di hosting.</span><span class="sxs-lookup"><span data-stu-id="4a39e-340">WebPI offers a standalone setup and a configuration for hosting providers.</span></span>

## <a name="create-the-iis-site"></a><span data-ttu-id="4a39e-341">Creare il sito IIS</span><span class="sxs-lookup"><span data-stu-id="4a39e-341">Create the IIS site</span></span>

1. <span data-ttu-id="4a39e-342">Nel sistema host creare una cartella per contenere le cartelle e i file pubblicati dell'app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-342">On the hosting system, create a folder to contain the app's published folders and files.</span></span> <span data-ttu-id="4a39e-343">In un passaggio successivo, il percorso della cartella viene fornito a IIS come percorso fisico dell'app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-343">In a following step, the folder's path is provided to IIS as the physical path to the app.</span></span> <span data-ttu-id="4a39e-344">Per altre informazioni sulla cartella di distribuzione e il layout dei file di un'app, vedere <xref:host-and-deploy/directory-structure>.</span><span class="sxs-lookup"><span data-stu-id="4a39e-344">For more information on an app's deployment folder and file layout, see <xref:host-and-deploy/directory-structure>.</span></span>

1. <span data-ttu-id="4a39e-345">In Gestione IIS aprire il nodo del server nel pannello **Connessioni**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-345">In IIS Manager, open the server's node in the **Connections** panel.</span></span> <span data-ttu-id="4a39e-346">Fare clic con il pulsante destro del mouse sulla cartella **Siti**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-346">Right-click the **Sites** folder.</span></span> <span data-ttu-id="4a39e-347">Scegliere **Aggiungi sito Web** dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="4a39e-347">Select **Add Website** from the contextual menu.</span></span>

1. <span data-ttu-id="4a39e-348">Specificare un **Nome del sito** e impostare il **Percorso fisico** per la cartella di distribuzione dell'app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-348">Provide a **Site name** and set the **Physical path** to the app's deployment folder.</span></span> <span data-ttu-id="4a39e-349">Specificare la configurazione in **Binding** e creare il sito Web scegliendo **OK**:</span><span class="sxs-lookup"><span data-stu-id="4a39e-349">Provide the **Binding** configuration and create the website by selecting **OK**:</span></span>

   ![Specificare il nome del sito, il percorso fisico e il nome Host nel passaggio Aggiungi sito Web.](index/_static/add-website-ws2016.png)

   > [!WARNING]
   > <span data-ttu-id="4a39e-351">Le associazioni con caratteri jolly di livello superiore (`http://*:80/` e `http://+:80`) **non** devono essere usate,</span><span class="sxs-lookup"><span data-stu-id="4a39e-351">Top-level wildcard bindings (`http://*:80/` and `http://+:80`) should **not** be used.</span></span> <span data-ttu-id="4a39e-352">poiché possono introdurre vulnerabilità a livello di sicurezza nell'app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-352">Top-level wildcard bindings can open up your app to security vulnerabilities.</span></span> <span data-ttu-id="4a39e-353">Questo concetto vale sia per i caratteri jolly sicuri che vulnerabili.</span><span class="sxs-lookup"><span data-stu-id="4a39e-353">This applies to both strong and weak wildcards.</span></span> <span data-ttu-id="4a39e-354">Usare nomi host espliciti al posto di caratteri jolly.</span><span class="sxs-lookup"><span data-stu-id="4a39e-354">Use explicit host names rather than wildcards.</span></span> <span data-ttu-id="4a39e-355">L'associazione con caratteri jolly del sottodominio (ad esempio, `*.mysub.com`) non costituisce un rischio per la sicurezza se viene controllato l'intero dominio padre (a differenza di `*.com`, che è vulnerabile).</span><span class="sxs-lookup"><span data-stu-id="4a39e-355">Subdomain wildcard binding (for example, `*.mysub.com`) doesn't have this security risk if you control the entire parent domain (as opposed to `*.com`, which is vulnerable).</span></span> <span data-ttu-id="4a39e-356">Vedere la [sezione 5.4 di RFC7230](https://tools.ietf.org/html/rfc7230#section-5.4) per altre informazioni.</span><span class="sxs-lookup"><span data-stu-id="4a39e-356">See [rfc7230 section-5.4](https://tools.ietf.org/html/rfc7230#section-5.4) for more information.</span></span>

1. <span data-ttu-id="4a39e-357">Nel nodo del server selezionare **Pool di applicazioni**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-357">Under the server's node, select **Application Pools**.</span></span>

1. <span data-ttu-id="4a39e-358">Fare clic con il pulsante destro del mouse sul pool di applicazioni del sito e scegliere **Impostazioni di base** dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="4a39e-358">Right-click the site's app pool and select **Basic Settings** from the contextual menu.</span></span>

1. <span data-ttu-id="4a39e-359">Nella finestra **Modifica pool di applicazioni** impostare **Versione .NET CLR** su **Nessun codice gestito**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-359">In the **Edit Application Pool** window, set the **.NET CLR version** to **No Managed Code**:</span></span>

   ![Impostare Nessun codice gestito per la versione .NET CLR.](index/_static/edit-apppool-ws2016.png)

    <span data-ttu-id="4a39e-361">ASP.NET Core viene eseguito in un processo separato e gestisce il runtime.</span><span class="sxs-lookup"><span data-stu-id="4a39e-361">ASP.NET Core runs in a separate process and manages the runtime.</span></span> <span data-ttu-id="4a39e-362">ASP.NET Core non si basa sul caricamento di Common Language Runtime (CLR di .NET) desktop. Core Common Language Runtime (CoreCLR) for .NET Core viene avviato per ospitare l'app nel processo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="4a39e-362">ASP.NET Core doesn't rely on loading the desktop CLR (.NET CLR)&mdash;the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process.</span></span> <span data-ttu-id="4a39e-363">L'impostazione di **Versione .NET CLR** su **Nessun codice gestito** è facoltativa ma consigliata.</span><span class="sxs-lookup"><span data-stu-id="4a39e-363">Setting the **.NET CLR version** to **No Managed Code** is optional but recommended.</span></span>

1. <span data-ttu-id="4a39e-364">*ASP.NET Core 2.2 o versioni successive*: per una [distribuzione autonoma](/dotnet/core/deploying/#self-contained-deployments-scd) a 64 bit (x64) che usa il [modello di hosting In-Process](#in-process-hosting-model), disabilitare il pool di app per i processi a 32 bit (x86).</span><span class="sxs-lookup"><span data-stu-id="4a39e-364">*ASP.NET Core 2.2 or later*: For a 64-bit (x64) [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd) that uses the [in-process hosting model](#in-process-hosting-model), disable the app pool for 32-bit (x86) processes.</span></span>

   <span data-ttu-id="4a39e-365">Nella barra laterale **Azioni** in Gestione IIS > **Pool di applicazioni** selezionare **Impostazioni predefinite pool di applicazioni** o **Impostazioni avanzate**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-365">In the **Actions** sidebar of IIS Manager > **Application Pools**, select **Set Application Pool Defaults** or **Advanced Settings**.</span></span> <span data-ttu-id="4a39e-366">Individuare **Attiva applicazioni a 32 bit** e impostare il valore su `False`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-366">Locate **Enable 32-Bit Applications** and set the value to `False`.</span></span> <span data-ttu-id="4a39e-367">Questa impostazione non viene applicata alle app distribuite per l'[hosting out-of-process](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span><span class="sxs-lookup"><span data-stu-id="4a39e-367">This setting doesn't affect apps deployed for [out-of-process hosting](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span></span>

1. <span data-ttu-id="4a39e-368">Confermare che l'identità del modello del processo disponga delle autorizzazioni appropriate.</span><span class="sxs-lookup"><span data-stu-id="4a39e-368">Confirm the process model identity has the proper permissions.</span></span>

   <span data-ttu-id="4a39e-369">Se l'identità predefinita del pool di app (**Modello di processo** > **Identità**) viene modificata da **ApplicationPoolIdentity** a un'altra identità, verificare che la nuova identità disponga delle autorizzazioni necessarie per l'accesso alla cartella dell'app, al database e alle altre risorse richieste.</span><span class="sxs-lookup"><span data-stu-id="4a39e-369">If the default identity of the app pool (**Process Model** > **Identity**) is changed from **ApplicationPoolIdentity** to another identity, verify that the new identity has the required permissions to access the app's folder, database, and other required resources.</span></span> <span data-ttu-id="4a39e-370">Ad esempio, il pool di applicazioni richiede l'accesso in lettura e scrittura alle cartelle in cui l'app legge e scrive i file.</span><span class="sxs-lookup"><span data-stu-id="4a39e-370">For example, the app pool requires read and write access to folders where the app reads and writes files.</span></span>

<span data-ttu-id="4a39e-371">**Configurazione dell'autenticazione di Windows (facoltativa)**</span><span class="sxs-lookup"><span data-stu-id="4a39e-371">**Windows Authentication configuration (Optional)**</span></span>  
<span data-ttu-id="4a39e-372">Per altre informazioni, vedere [Configurare l'autenticazione Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="4a39e-372">For more information, see [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

## <a name="deploy-the-app"></a><span data-ttu-id="4a39e-373">Distribuire l'app</span><span class="sxs-lookup"><span data-stu-id="4a39e-373">Deploy the app</span></span>

<span data-ttu-id="4a39e-374">Distribuire l'app nella cartella **Percorso fisico** di IIS specificata nella sezione [Creare il sito IIS](#create-the-iis-site).</span><span class="sxs-lookup"><span data-stu-id="4a39e-374">Deploy the app to the IIS **Physical path** folder that was established in the [Create the IIS site](#create-the-iis-site) section.</span></span> <span data-ttu-id="4a39e-375">[Distribuzione Web](/iis/publish/using-web-deploy/introduction-to-web-deploy) è il meccanismo consigliato per la distribuzione, ma esistono diverse opzioni per spostare l'app dalla cartella di *pubblicazione* del progetto alla cartella di distribuzione del sistema di hosting.</span><span class="sxs-lookup"><span data-stu-id="4a39e-375">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) is the recommended mechanism for deployment, but several options exist for moving the app from the project's *publish* folder to the hosting system's deployment folder.</span></span>

### <a name="web-deploy-with-visual-studio"></a><span data-ttu-id="4a39e-376">Distribuzione web con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="4a39e-376">Web Deploy with Visual Studio</span></span>

<span data-ttu-id="4a39e-377">Vedere l'argomento [Visual Studio publish profiles for ASP.NET Core app deployment](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) (Profili di pubblicazione Visual Studio per la distribuzione di app ASP.NET Core) per informazioni su come creare un profilo di pubblicazione da usare con Distribuzione Web.</span><span class="sxs-lookup"><span data-stu-id="4a39e-377">See the [Visual Studio publish profiles for ASP.NET Core app deployment](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) topic to learn how to create a publish profile for use with Web Deploy.</span></span> <span data-ttu-id="4a39e-378">Se il provider di hosting fornisce un profilo di pubblicazione o il supporto per crearne uno, scaricare il profilo e importarlo usando la finestra di dialogo **Pubblica** di Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="4a39e-378">If the hosting provider provides a Publish Profile or support for creating one, download their profile and import it using the Visual Studio **Publish** dialog:</span></span>

![Pagina della finestra di dialogo Pubblica](index/_static/pub-dialog.png)

### <a name="web-deploy-outside-of-visual-studio"></a><span data-ttu-id="4a39e-380">Distribuzione Web all'esterno di Visual Studio</span><span class="sxs-lookup"><span data-stu-id="4a39e-380">Web Deploy outside of Visual Studio</span></span>

<span data-ttu-id="4a39e-381">È anche possibile usare [Distribuzione Web](/iis/publish/using-web-deploy/introduction-to-web-deploy) all'esterno di Visual Studio dalla riga di comando.</span><span class="sxs-lookup"><span data-stu-id="4a39e-381">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) can also be used outside of Visual Studio from the command line.</span></span> <span data-ttu-id="4a39e-382">Per altre informazioni sulla distribuzione, vedere [Strumento Distribuzione Web](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span><span class="sxs-lookup"><span data-stu-id="4a39e-382">For more information, see [Web Deployment Tool](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span></span>

### <a name="alternatives-to-web-deploy"></a><span data-ttu-id="4a39e-383">Alternative a Distribuzione web</span><span class="sxs-lookup"><span data-stu-id="4a39e-383">Alternatives to Web Deploy</span></span>

<span data-ttu-id="4a39e-384">Usare uno dei metodi disponibili, ad esempio la copia manuale, [Xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy) o [PowerShell](/powershell/), per spostare l'app nel sistema di hosting.</span><span class="sxs-lookup"><span data-stu-id="4a39e-384">Use any of several methods to move the app to the hosting system, such as manual copy, [Xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy), or [PowerShell](/powershell/).</span></span>

<span data-ttu-id="4a39e-385">Per altre informazioni sulla distribuzione di ASP.NET Core in IIS, vedere la sezione [Risorse di distribuzione per amministratori IIS](#deployment-resources-for-iis-administrators).</span><span class="sxs-lookup"><span data-stu-id="4a39e-385">For more information on ASP.NET Core deployment to IIS, see the [Deployment resources for IIS administrators](#deployment-resources-for-iis-administrators) section.</span></span>

## <a name="browse-the-website"></a><span data-ttu-id="4a39e-386">Esplorare il sito Web</span><span class="sxs-lookup"><span data-stu-id="4a39e-386">Browse the website</span></span>

<span data-ttu-id="4a39e-387">Dopo aver distribuito l'app nel sistema di hosting, effettuare una richiesta a uno degli endpoint pubblici dell'app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-387">After the app is deployed to the hosting system, make a request to one of the app's public endpoints.</span></span>

<span data-ttu-id="4a39e-388">Nell'esempio seguente il sito è associato al **nome host** di IIS `www.mysite.com` sulla **porta** `80`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-388">In the following example, the site is bound to an IIS **Host name** of `www.mysite.com` on **Port** `80`.</span></span> <span data-ttu-id="4a39e-389">Viene effettuata una richiesta a `http://www.mysite.com`:</span><span class="sxs-lookup"><span data-stu-id="4a39e-389">A request is made to `http://www.mysite.com`:</span></span>

![Il browser Microsoft Edge ha caricato la pagina di avvio IIS.](index/_static/browsewebsite.png)

## <a name="locked-deployment-files"></a><span data-ttu-id="4a39e-391">File di distribuzione bloccati</span><span class="sxs-lookup"><span data-stu-id="4a39e-391">Locked deployment files</span></span>

<span data-ttu-id="4a39e-392">I file nella cartella di distribuzione sono bloccati durante l'esecuzione dell'app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-392">Files in the deployment folder are locked when the app is running.</span></span> <span data-ttu-id="4a39e-393">I file bloccati non possono essere sovrascritti durante la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="4a39e-393">Locked files can't be overwritten during deployment.</span></span> <span data-ttu-id="4a39e-394">Per rilasciare i file bloccati in una distribuzione, arrestare il pool di applicazioni usando **uno** dei metodi seguenti:</span><span class="sxs-lookup"><span data-stu-id="4a39e-394">To release locked files in a deployment, stop the app pool using **one** of the following approaches:</span></span>

* <span data-ttu-id="4a39e-395">Usare Distribuzione Web e fare riferimento a `Microsoft.NET.Sdk.Web` nel file di progetto.</span><span class="sxs-lookup"><span data-stu-id="4a39e-395">Use Web Deploy and reference `Microsoft.NET.Sdk.Web` in the project file.</span></span> <span data-ttu-id="4a39e-396">Nella radice della directory dell'app web viene posizionato un file *app_offline.htm*.</span><span class="sxs-lookup"><span data-stu-id="4a39e-396">An *app_offline.htm* file is placed at the root of the web app directory.</span></span> <span data-ttu-id="4a39e-397">Quando il file è presente, il modulo ASP.NET Core arresta normalmente l'app e rende disponibile il file *app_offline.htm* durante la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="4a39e-397">When the file is present, the ASP.NET Core Module gracefully shuts down the app and serves the *app_offline.htm* file during the deployment.</span></span> <span data-ttu-id="4a39e-398">Per altre informazioni, vedere la [Guida di riferimento per la configurazione del modulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span><span class="sxs-lookup"><span data-stu-id="4a39e-398">For more information, see the [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span></span>
* <span data-ttu-id="4a39e-399">Arrestare manualmente il pool di applicazioni in Gestione IIS sul server.</span><span class="sxs-lookup"><span data-stu-id="4a39e-399">Manually stop the app pool in the IIS Manager on the server.</span></span>
* <span data-ttu-id="4a39e-400">Usare PowerShell per eliminare *App_offline. htm* (richiede PowerShell 5 o versione successiva):</span><span class="sxs-lookup"><span data-stu-id="4a39e-400">Use PowerShell to drop *app_offline.htm* (requires PowerShell 5 or later):</span></span>

  ```PowerShell
  $pathToApp = 'PATH_TO_APP'

  # Stop the AppPool
  New-Item -Path $pathToApp app_offline.htm

  # Provide script commands here to deploy the app

  # Restart the AppPool
  Remove-Item -Path $pathToApp app_offline.htm

  ```

## <a name="data-protection"></a><span data-ttu-id="4a39e-401">Protezione dei dati</span><span class="sxs-lookup"><span data-stu-id="4a39e-401">Data protection</span></span>

<span data-ttu-id="4a39e-402">Lo [stack di protezione dei dati di ASP.NET Core](xref:security/data-protection/introduction) viene usato da diversi [middleware](xref:fundamentals/middleware/index) di ASP.NET Core, inclusi quelli usati nell'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="4a39e-402">The [ASP.NET Core Data Protection stack](xref:security/data-protection/introduction) is used by several ASP.NET Core [middlewares](xref:fundamentals/middleware/index), including middleware used in authentication.</span></span> <span data-ttu-id="4a39e-403">Anche se le DPAPI (Data Protection API) non vengono chiamate dal codice dell'utente, è consigliabile configurare la protezione dati per la creazione di un [archivio di chiavi](xref:security/data-protection/implementation/key-management) crittografiche permanente con uno script di distribuzione o nel codice dell'utente.</span><span class="sxs-lookup"><span data-stu-id="4a39e-403">Even if Data Protection APIs aren't called by user code, data protection should be configured with a deployment script or in user code to create a persistent cryptographic [key store](xref:security/data-protection/implementation/key-management).</span></span> <span data-ttu-id="4a39e-404">Se non si configura la protezione dei dati, le chiavi vengono mantenute in memoria ed eliminate al riavvio dell'app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-404">If data protection isn't configured, the keys are held in memory and discarded when the app restarts.</span></span>

<span data-ttu-id="4a39e-405">Se il gruppo di chiavi viene archiviato in memoria quando l'app viene riavviata:</span><span class="sxs-lookup"><span data-stu-id="4a39e-405">If the key ring is stored in memory when the app restarts:</span></span>

* <span data-ttu-id="4a39e-406">Tutti i token di autenticazione basati su cookie vengono invalidati.</span><span class="sxs-lookup"><span data-stu-id="4a39e-406">All cookie-based authentication tokens are invalidated.</span></span> 
* <span data-ttu-id="4a39e-407">Gli utenti devono ripetere l'accesso alla richiesta successiva.</span><span class="sxs-lookup"><span data-stu-id="4a39e-407">Users are required to sign in again on their next request.</span></span> 
* <span data-ttu-id="4a39e-408">Tutti i dati protetti con il gruppo di chiavi non possono più essere decrittografati.</span><span class="sxs-lookup"><span data-stu-id="4a39e-408">Any data protected with the key ring can no longer be decrypted.</span></span> <span data-ttu-id="4a39e-409">Possono essere inclusi i [token CSRF](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) e i [cookie TempData di ASP.NET Core MVC](xref:fundamentals/app-state#tempdata).</span><span class="sxs-lookup"><span data-stu-id="4a39e-409">This may include [CSRF tokens](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) and [ASP.NET Core MVC TempData cookies](xref:fundamentals/app-state#tempdata).</span></span>

<span data-ttu-id="4a39e-410">Per configurare la protezione dati in IIS in modo da rendere permanente il gruppo di chiavi, usare **uno** degli approcci seguenti:</span><span class="sxs-lookup"><span data-stu-id="4a39e-410">To configure data protection under IIS to persist the key ring, use **one** of the following approaches:</span></span>

* <span data-ttu-id="4a39e-411">**Creare chiavi del Registro di sistema di protezione dati**</span><span class="sxs-lookup"><span data-stu-id="4a39e-411">**Create Data Protection Registry Keys**</span></span>

  <span data-ttu-id="4a39e-412">Le chiavi di protezione dati usate dalle app ASP.NET Core vengono archiviate nel Registro di sistema esterno alle app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-412">Data protection keys used by ASP.NET Core apps are stored in the registry external to the apps.</span></span> <span data-ttu-id="4a39e-413">Per mantenere le chiavi per una determinata app, creare chiavi del Registro di sistema per il pool di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="4a39e-413">To persist the keys for a given app, create registry keys for the app pool.</span></span>

  <span data-ttu-id="4a39e-414">Per le installazioni IIS autonome non web farm è possibile usare lo [script PowerShell Data Protection Provision-AutoGenKeys.ps1 (Provisioning di protezione dati-AutoGenKeys.ps1)](https://github.com/aspnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) per ogni pool di app usato con un'app ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="4a39e-414">For standalone, non-webfarm IIS installations, the [Data Protection Provision-AutoGenKeys.ps1 PowerShell script](https://github.com/aspnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) can be used for each app pool used with an ASP.NET Core app.</span></span> <span data-ttu-id="4a39e-415">Questo script crea una chiave del Registro di sistema nel registro HKLM accessibile solo all'account del processo di lavoro del pool di applicazioni dell'app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-415">This script creates a registry key in the HKLM registry that's accessible only to the worker process account of the app's app pool.</span></span> <span data-ttu-id="4a39e-416">Le chiavi vengono crittografate a riposo tramite DPAPI con una chiave a livello del computer.</span><span class="sxs-lookup"><span data-stu-id="4a39e-416">Keys are encrypted at rest using DPAPI with a machine-wide key.</span></span>

  <span data-ttu-id="4a39e-417">In scenari di web farm un'app può essere configurata in modo da usare un percorso UNC in cui archiviare il proprio gruppo di chiavi di protezione dati.</span><span class="sxs-lookup"><span data-stu-id="4a39e-417">In web farm scenarios, an app can be configured to use a UNC path to store its data protection key ring.</span></span> <span data-ttu-id="4a39e-418">Per impostazione predefinita, le chiavi di protezione dati non vengono crittografate.</span><span class="sxs-lookup"><span data-stu-id="4a39e-418">By default, the data protection keys aren't encrypted.</span></span> <span data-ttu-id="4a39e-419">Assicurarsi che le autorizzazioni file per la condivisione di rete siano limitate all'account di Windows in cui viene eseguita l'app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-419">Ensure that the file permissions for the network share are limited to the Windows account the app runs under.</span></span> <span data-ttu-id="4a39e-420">È possibile usare un certificato X509 per la protezione delle chiavi inattive.</span><span class="sxs-lookup"><span data-stu-id="4a39e-420">An X509 certificate can be used to protect keys at rest.</span></span> <span data-ttu-id="4a39e-421">Considerare l'implementazione di un meccanismo per consentire agli utenti di caricare i certificati: inserire i certificati nell'archivio certificati attendibili dell'utente e assicurarsi che siano disponibili in tutti i computer in cui viene eseguita l'app dell'utente.</span><span class="sxs-lookup"><span data-stu-id="4a39e-421">Consider a mechanism to allow users to upload certificates: Place certificates into the user's trusted certificate store and ensure they're available on all machines where the user's app runs.</span></span> <span data-ttu-id="4a39e-422">Vedere [Configurare la protezione dati di ASP.NET Core](xref:security/data-protection/configuration/overview) per altri dettagli.</span><span class="sxs-lookup"><span data-stu-id="4a39e-422">See [Configure ASP.NET Core Data Protection](xref:security/data-protection/configuration/overview) for details.</span></span>

* <span data-ttu-id="4a39e-423">**Configurare il pool di applicazioni IIS per caricare il profilo utente**</span><span class="sxs-lookup"><span data-stu-id="4a39e-423">**Configure the IIS Application Pool to load the user profile**</span></span>

  <span data-ttu-id="4a39e-424">Questa impostazione si trova nella sezione **Modello del processo** in **Impostazioni avanzate** per il pool di app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-424">This setting is in the **Process Model** section under the **Advanced Settings** for the app pool.</span></span> <span data-ttu-id="4a39e-425">Impostare **Caricamento del profilo utente** su `True`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-425">Set **Load User Profile** to `True`.</span></span> <span data-ttu-id="4a39e-426">Con l'impostazione `True` le chiavi vengono archiviate nella directory del profilo utente e protette tramite DPAPI con una chiave specifica per l'account utente.</span><span class="sxs-lookup"><span data-stu-id="4a39e-426">When set to `True`, keys are stored in the user profile directory and protected using DPAPI with a key specific to the user account.</span></span> <span data-ttu-id="4a39e-427">Le chiavi vengono salvate in modo permanente nella cartella *%LOCALAPPDATA%/ASP.NET/DataProtection-Keys*.</span><span class="sxs-lookup"><span data-stu-id="4a39e-427">Keys are persisted to the *%LOCALAPPDATA%/ASP.NET/DataProtection-Keys* folder.</span></span>

  <span data-ttu-id="4a39e-428">Deve essere abilitato anche l'[attributo setProfileEnvironment](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) del pool di app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-428">The app pool's [setProfileEnvironment attribute](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) must also be enabled.</span></span> <span data-ttu-id="4a39e-429">Il valore predefinito di `setProfileEnvironment` è `true`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-429">The default value of `setProfileEnvironment` is `true`.</span></span> <span data-ttu-id="4a39e-430">In alcuni scenari (ad esempio, per il sistema operativo Windows), `setProfileEnvironment` è impostato su `false`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-430">In some scenarios (for example, Windows OS), `setProfileEnvironment` is set to `false`.</span></span> <span data-ttu-id="4a39e-431">Se le chiavi non vengono archiviate nella directory del profilo utente come previsto:</span><span class="sxs-lookup"><span data-stu-id="4a39e-431">If keys aren't stored in the user profile directory as expected:</span></span>

  1. <span data-ttu-id="4a39e-432">Passare alla cartella *%windir%/system32/inetsrv/config*.</span><span class="sxs-lookup"><span data-stu-id="4a39e-432">Navigate to the *%windir%/system32/inetsrv/config* folder.</span></span>
  1. <span data-ttu-id="4a39e-433">Aprire il file *applicationHost.config*.</span><span class="sxs-lookup"><span data-stu-id="4a39e-433">Open the *applicationHost.config* file.</span></span>
  1. <span data-ttu-id="4a39e-434">Individuare l'elemento `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` .</span><span class="sxs-lookup"><span data-stu-id="4a39e-434">Locate the `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` element.</span></span>
  1. <span data-ttu-id="4a39e-435">Verificare che l'attributo `setProfileEnvironment` non sia presente, condizione che corrisponde all'impostazione predefinita `true`, o impostare in modo esplicito il valore dell'attributo su `true`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-435">Confirm that the `setProfileEnvironment` attribute isn't present, which defaults the value to `true`, or explicitly set the attribute's value to `true`.</span></span>

* <span data-ttu-id="4a39e-436">**Usare il file system come archivio del gruppo di chiavi**</span><span class="sxs-lookup"><span data-stu-id="4a39e-436">**Use the file system as a key ring store**</span></span>

  <span data-ttu-id="4a39e-437">Modificare il codice dell'app per [usare il file system come archivio del gruppo di chiavi](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="4a39e-437">Adjust the app code to [use the file system as a key ring store](xref:security/data-protection/configuration/overview).</span></span> <span data-ttu-id="4a39e-438">Usare un certificato X509 per proteggere il gruppo di chiavi e verificare che sia un certificato attendibile.</span><span class="sxs-lookup"><span data-stu-id="4a39e-438">Use an X509 certificate to protect the key ring and ensure the certificate is a trusted certificate.</span></span> <span data-ttu-id="4a39e-439">Se il certificato è autofirmato, inserirlo nell'archivio radice attendibile.</span><span class="sxs-lookup"><span data-stu-id="4a39e-439">If the certificate is self-signed, place the certificate in the Trusted Root store.</span></span>

  <span data-ttu-id="4a39e-440">Quando si usa IIS in una web farm:</span><span class="sxs-lookup"><span data-stu-id="4a39e-440">When using IIS in a web farm:</span></span>

  * <span data-ttu-id="4a39e-441">Usare una condivisione di file a cui possono accedere tutti i computer.</span><span class="sxs-lookup"><span data-stu-id="4a39e-441">Use a file share that all machines can access.</span></span>
  * <span data-ttu-id="4a39e-442">Distribuire un certificato X509 in ogni computer.</span><span class="sxs-lookup"><span data-stu-id="4a39e-442">Deploy an X509 certificate to each machine.</span></span> <span data-ttu-id="4a39e-443">Configurare [protezione dei dati nel codice](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="4a39e-443">Configure [data protection in code](xref:security/data-protection/configuration/overview).</span></span>

* <span data-ttu-id="4a39e-444">**Impostare criteri a livello di computer per la protezione dei dati**</span><span class="sxs-lookup"><span data-stu-id="4a39e-444">**Set a machine-wide policy for data protection**</span></span>

  <span data-ttu-id="4a39e-445">Il sistema di protezione dei dati ha un supporto limitato per l'impostazione di [criteri a livello di computer](xref:security/data-protection/configuration/machine-wide-policy) predefiniti per tutte le app che usano le API di protezione dei dati.</span><span class="sxs-lookup"><span data-stu-id="4a39e-445">The data protection system has limited support for setting a default [machine-wide policy](xref:security/data-protection/configuration/machine-wide-policy) for all apps that consume the Data Protection APIs.</span></span> <span data-ttu-id="4a39e-446">Per ulteriori informazioni, vedere <xref:security/data-protection/introduction>.</span><span class="sxs-lookup"><span data-stu-id="4a39e-446">For more information, see <xref:security/data-protection/introduction>.</span></span>

## <a name="virtual-directories"></a><span data-ttu-id="4a39e-447">Directory virtuali</span><span class="sxs-lookup"><span data-stu-id="4a39e-447">Virtual Directories</span></span>

<span data-ttu-id="4a39e-448">Le [directory virtuali IIS](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) non sono supportate con le app ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="4a39e-448">[IIS Virtual Directories](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) aren't supported with ASP.NET Core apps.</span></span> <span data-ttu-id="4a39e-449">Un'app può essere ospitata come [applicazione secondaria](#sub-applications).</span><span class="sxs-lookup"><span data-stu-id="4a39e-449">An app can be hosted as a [sub-application](#sub-applications).</span></span>

## <a name="sub-applications"></a><span data-ttu-id="4a39e-450">Applicazioni secondarie</span><span class="sxs-lookup"><span data-stu-id="4a39e-450">Sub-applications</span></span>

<span data-ttu-id="4a39e-451">Un'app ASP.NET Core può essere ospitata come [applicazione secondaria di IIS (app secondaria)](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span><span class="sxs-lookup"><span data-stu-id="4a39e-451">An ASP.NET Core app can be hosted as an [IIS sub-application (sub-app)](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span></span> <span data-ttu-id="4a39e-452">Il percorso dell'app secondaria diventa parte dell'URL dell'app radice.</span><span class="sxs-lookup"><span data-stu-id="4a39e-452">The sub-app's path becomes part of the root app's URL.</span></span>

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="4a39e-453">Un'app secondaria non deve includere il modulo ASP.NET Core come gestore.</span><span class="sxs-lookup"><span data-stu-id="4a39e-453">A sub-app shouldn't include the ASP.NET Core Module as a handler.</span></span> <span data-ttu-id="4a39e-454">Se il modulo viene aggiunto come gestore nel file *web.config* di un'app secondaria, quando si prova a esplorare l'app secondaria si riceve un messaggio 500.19 *(errore interno del server)* che segnala errori nel file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="4a39e-454">If the module is added as a handler in a sub-app's *web.config* file, a *500.19 Internal Server Error* referencing the faulty config file is received when attempting to browse the sub-app.</span></span>

<span data-ttu-id="4a39e-455">L'esempio seguente illustra un file *web.config* pubblicato per un'app secondaria di ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="4a39e-455">The following example shows a published *web.config* file for an ASP.NET Core sub-app:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <aspNetCore processPath="dotnet" 
      arguments=".\MyApp.dll" 
      stdoutLogEnabled="false" 
      stdoutLogFile=".\logs\stdout" />
  </system.webServer>
</configuration>
```

<span data-ttu-id="4a39e-456">Quando si ospita un'app secondaria non ASP.NET Core in un'app ASP.NET Core, è necessario rimuovere in modo esplicito il gestore ereditato nel file *web.config* dell'app secondaria:</span><span class="sxs-lookup"><span data-stu-id="4a39e-456">When hosting a non-ASP.NET Core sub-app underneath an ASP.NET Core app, explicitly remove the inherited handler in the sub-app's *web.config* file:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <handlers>
      <remove name="aspNetCore" />
    </handlers>
    <aspNetCore processPath="dotnet" 
      arguments=".\MyApp.dll" 
      stdoutLogEnabled="false" 
      stdoutLogFile=".\logs\stdout" />
  </system.webServer>
</configuration>
```

::: moniker-end

<span data-ttu-id="4a39e-457">I collegamenti ad asset statici all'interno dell'app secondaria devono usare la notazione con tilde-barra (`~/`).</span><span class="sxs-lookup"><span data-stu-id="4a39e-457">Static asset links within the sub-app should use tilde-slash (`~/`) notation.</span></span> <span data-ttu-id="4a39e-458">La notazione con tilde-barra attiva un [helper tag](xref:mvc/views/tag-helpers/intro) per anteporre la base del percorso dell'app secondaria al collegamento relativo sottoposto a rendering.</span><span class="sxs-lookup"><span data-stu-id="4a39e-458">Tilde-slash notation triggers a [Tag Helper](xref:mvc/views/tag-helpers/intro) to prepend the sub-app's pathbase to the rendered relative link.</span></span> <span data-ttu-id="4a39e-459">Per un'app secondaria in `/subapp_path`, il rendering di un'immagine collegata con `src="~/image.png"` viene eseguito come `src="/subapp_path/image.png"`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-459">For a sub-app at `/subapp_path`, an image linked with `src="~/image.png"` is rendered as `src="/subapp_path/image.png"`.</span></span> <span data-ttu-id="4a39e-460">Il middleware dei file statici dell'app radice non elabora la richiesta di file statici.</span><span class="sxs-lookup"><span data-stu-id="4a39e-460">The root app's Static File Middleware doesn't process the static file request.</span></span> <span data-ttu-id="4a39e-461">La richiesta viene elaborata dal middleware dei file statici dell'app secondaria.</span><span class="sxs-lookup"><span data-stu-id="4a39e-461">The request is processed by the sub-app's Static File Middleware.</span></span>

<span data-ttu-id="4a39e-462">Se l'attributo `src` di un asset statico viene impostato su un percorso assoluto (ad esempio, `src="/image.png"`), il rendering del collegamento viene eseguito senza la base del percorso dell'app secondaria.</span><span class="sxs-lookup"><span data-stu-id="4a39e-462">If a static asset's `src` attribute is set to an absolute path (for example, `src="/image.png"`), the link is rendered without the sub-app's pathbase.</span></span> <span data-ttu-id="4a39e-463">Il middleware dei file statici dell'app radice prova a servire l'asset dalla [radice Web](xref:fundamentals/index#web-root) dell'app radice con conseguente risposta *404 - Non trovato*, a meno che l'asset statico non sia disponibile dal'app radice.</span><span class="sxs-lookup"><span data-stu-id="4a39e-463">The root app's Static File Middleware attempts to serve the asset from the root app's [web root](xref:fundamentals/index#web-root), which results in a *404 - Not Found* response unless the static asset is available from the root app.</span></span>

<span data-ttu-id="4a39e-464">Per ospitare un'app ASP.NET Core come app secondaria in un'altra app ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="4a39e-464">To host an ASP.NET Core app as a sub-app under another ASP.NET Core app:</span></span>

1. <span data-ttu-id="4a39e-465">Definire un pool di app per l'app secondaria.</span><span class="sxs-lookup"><span data-stu-id="4a39e-465">Establish an app pool for the sub-app.</span></span> <span data-ttu-id="4a39e-466">Impostare **Versione .NET CLR** su **Nessun codice gestito** perché Core Common Language Runtime (CoreCLR) for .NET Core viene avviato per ospitare l'app nel processo di lavoro e non CLR desktop (.NET CLR).</span><span class="sxs-lookup"><span data-stu-id="4a39e-466">Set the **.NET CLR Version** to **No Managed Code** because the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process, not the desktop CLR (.NET CLR).</span></span>

1. <span data-ttu-id="4a39e-467">Aggiungere il sito radice in Gestione IIS con l'applicazione secondaria in una cartella all'interno del sito principale.</span><span class="sxs-lookup"><span data-stu-id="4a39e-467">Add the root site in IIS Manager with the sub-app in a folder under the root site.</span></span>

1. <span data-ttu-id="4a39e-468">Fare clic con il pulsante destro del mouse sulla cartella dell'applicazione secondaria in Gestione IIS e scegliere **Converti in applicazione**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-468">Right-click the sub-app folder in IIS Manager and select **Convert to Application**.</span></span>

1. <span data-ttu-id="4a39e-469">Nella finestra di dialogo **Aggiungi applicazione** usare il pulsante **Seleziona** per **Pool di applicazioni** per assegnare il pool di app creato per l'app secondaria.</span><span class="sxs-lookup"><span data-stu-id="4a39e-469">In the **Add Application** dialog, use the **Select** button for the **Application Pool** to assign the app pool that you created for the sub-app.</span></span> <span data-ttu-id="4a39e-470">Scegliere **OK**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-470">Select **OK**.</span></span>

<span data-ttu-id="4a39e-471">L'assegnazione di un pool di app separato all'app secondaria è un requisito quando si usa il modello di hosting in-process.</span><span class="sxs-lookup"><span data-stu-id="4a39e-471">The assignment of a separate app pool to the sub-app is a requirement when using the in-process hosting model.</span></span>

<span data-ttu-id="4a39e-472">Per altre informazioni sul modello di hosting in-process e sulla configurazione del modulo ASP.NET Core, vedere <xref:host-and-deploy/aspnet-core-module> e <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="4a39e-472">For more information on the in-process hosting model and configuring the ASP.NET Core Module, see <xref:host-and-deploy/aspnet-core-module> and <xref:host-and-deploy/aspnet-core-module>.</span></span>

## <a name="configuration-of-iis-with-webconfig"></a><span data-ttu-id="4a39e-473">Configurazione di IIS con web.config</span><span class="sxs-lookup"><span data-stu-id="4a39e-473">Configuration of IIS with web.config</span></span>

<span data-ttu-id="4a39e-474">La configurazione di IIS è influenzata dalla sezione `<system.webServer>` di *web.config* per gli scenari IIS funzionali per le app ASP.NET Core con il modulo ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="4a39e-474">IIS configuration is influenced by the `<system.webServer>` section of *web.config* for IIS scenarios that are functional for ASP.NET Core apps with the ASP.NET Core Module.</span></span> <span data-ttu-id="4a39e-475">Ad esempio, la configurazione di IIS è funzionale per la compressione dinamica.</span><span class="sxs-lookup"><span data-stu-id="4a39e-475">For example, IIS configuration is functional for dynamic compression.</span></span> <span data-ttu-id="4a39e-476">Se IIS è configurato a livello di server per l'uso della compressione dinamica, l'elemento `<urlCompression>` nel file *web.config* dell'app può disabilitare questa impostazione per un'app ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="4a39e-476">If IIS is configured at the server level to use dynamic compression, the `<urlCompression>` element in the app's *web.config* file can disable it for an ASP.NET Core app.</span></span>

<span data-ttu-id="4a39e-477">Per altre informazioni, vedere la [guida di riferimento per la configurazione di \<system.webServer>](/iis/configuration/system.webServer/), la [guida di riferimento per la configurazione del modulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module) e [Moduli IIS con ASP.NET Core](xref:host-and-deploy/iis/modules).</span><span class="sxs-lookup"><span data-stu-id="4a39e-477">For more information, see the [configuration reference for \<system.webServer>](/iis/configuration/system.webServer/), [ASP.NET Core Module Configuration Reference](xref:host-and-deploy/aspnet-core-module), and [IIS Modules with ASP.NET Core](xref:host-and-deploy/iis/modules).</span></span> <span data-ttu-id="4a39e-478">Per impostare variabili di ambiente per singole app in esecuzione in pool di applicazioni isolate (supportati per IIS 10.0 o versioni successive), vedere la sezione *Comando AppCmd.exe* dell'argomento [Variabili di ambiente \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) nella documentazione di riferimento di IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-478">To set environment variables for individual apps running in isolated app pools (supported for IIS 10.0 or later), see the *AppCmd.exe command* section of the [Environment Variables \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) topic in the IIS reference documentation.</span></span>

## <a name="configuration-sections-of-webconfig"></a><span data-ttu-id="4a39e-479">Sezioni di configurazione di web.config</span><span class="sxs-lookup"><span data-stu-id="4a39e-479">Configuration sections of web.config</span></span>

<span data-ttu-id="4a39e-480">Le sezioni di configurazione di app ASP.NET 4.x in *web.config* non vengono usate dalle app ASP.NET Core per la configurazione:</span><span class="sxs-lookup"><span data-stu-id="4a39e-480">Configuration sections of ASP.NET 4.x apps in *web.config* aren't used by ASP.NET Core apps for configuration:</span></span>

* `<system.web>`
* `<appSettings>`
* `<connectionStrings>`
* `<location>`

<span data-ttu-id="4a39e-481">Le applicazioni ASP.NET Core vengono configurate tramite altri provider di configurazione.</span><span class="sxs-lookup"><span data-stu-id="4a39e-481">ASP.NET Core apps are configured using other configuration providers.</span></span> <span data-ttu-id="4a39e-482">Per altre informazioni, vedere [Configurazione](xref:fundamentals/configuration/index).</span><span class="sxs-lookup"><span data-stu-id="4a39e-482">For more information, see [Configuration](xref:fundamentals/configuration/index).</span></span>

## <a name="application-pools"></a><span data-ttu-id="4a39e-483">Pool di applicazioni</span><span class="sxs-lookup"><span data-stu-id="4a39e-483">Application Pools</span></span>

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="4a39e-484">L'isolamento dei pool di app è determinato dal modello di hosting:</span><span class="sxs-lookup"><span data-stu-id="4a39e-484">App pool isolation is determined by the hosting model:</span></span>

* <span data-ttu-id="4a39e-485">Hosting in-process &ndash; Le app devono essere eseguite in pool di app separati.</span><span class="sxs-lookup"><span data-stu-id="4a39e-485">In-process hosting &ndash; Apps are required to run in separate app pools.</span></span>
* <span data-ttu-id="4a39e-486">Hosting out-of-process &ndash; È consigliabile isolare le app le une dalle altre eseguendo ogni app nel relativo pool di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="4a39e-486">Out-of-process hosting &ndash; We recommend isolating the apps from each other by running each app in its own app pool.</span></span>

<span data-ttu-id="4a39e-487">Nella finestra di dialogo **Aggiungi sito Web** è selezionato per impostazione predefinita un singolo pool di app per ogni app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-487">The IIS **Add Website** dialog defaults to a single app pool per app.</span></span> <span data-ttu-id="4a39e-488">Quando si specifica un valore in **Nome del sito**, il testo viene automaticamente trasferito alla casella di testo **Pool di applicazioni**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-488">When a **Site name** is provided, the text is automatically transferred to the **Application pool** textbox.</span></span> <span data-ttu-id="4a39e-489">Quando si aggiunge il sito viene creato un nuovo pool di applicazioni con il nome del sito.</span><span class="sxs-lookup"><span data-stu-id="4a39e-489">A new app pool is created using the site name when the site is added.</span></span>

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="4a39e-490">Quando si ospitano più siti Web in un server, è consigliabile isolare le app le une dalle altre eseguendo ogni app nel relativo pool di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="4a39e-490">When hosting multiple websites on a server, we recommend isolating the apps from each other by running each app in its own app pool.</span></span> <span data-ttu-id="4a39e-491">La finestra di dialogo **Aggiungi sito Web** di IIS ha questa configurazione come impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="4a39e-491">The IIS **Add Website** dialog defaults to this configuration.</span></span> <span data-ttu-id="4a39e-492">Quando si specifica un valore in **Nome del sito**, il testo viene automaticamente trasferito alla casella di testo **Pool di applicazioni**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-492">When a **Site name** is provided, the text is automatically transferred to the **Application pool** textbox.</span></span> <span data-ttu-id="4a39e-493">Quando si aggiunge il sito viene creato un nuovo pool di applicazioni con il nome del sito.</span><span class="sxs-lookup"><span data-stu-id="4a39e-493">A new app pool is created using the site name when the site is added.</span></span>

::: moniker-end

## <a name="application-pool-identity"></a><span data-ttu-id="4a39e-494">Identità del pool di applicazione</span><span class="sxs-lookup"><span data-stu-id="4a39e-494">Application Pool Identity</span></span>

<span data-ttu-id="4a39e-495">Un account di identità del pool di app consente di eseguire un'app in un account univoco, senza dover creare e gestire domini o account locali.</span><span class="sxs-lookup"><span data-stu-id="4a39e-495">An app pool identity account allows an app to run under a unique account without having to create and manage domains or local accounts.</span></span> <span data-ttu-id="4a39e-496">In IIS 8.0 o versioni successive il processo di lavoro amministrazione IIS (WAS) crea un account virtuale con il nome del nuovo pool di applicazioni ed esegue i processi di lavoro del pool di applicazioni inclusi nell'account per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="4a39e-496">On IIS 8.0 or later, the IIS Admin Worker Process (WAS) creates a virtual account with the name of the new app pool and runs the app pool's worker processes under this account by default.</span></span> <span data-ttu-id="4a39e-497">Nella Console di gestione IIS in **Impostazioni avanzate** per il pool di app verificare che **Identità** sia impostata su **ApplicationPoolIdentity**:</span><span class="sxs-lookup"><span data-stu-id="4a39e-497">In the IIS Management Console under **Advanced Settings** for the app pool, ensure that the **Identity** is set to use **ApplicationPoolIdentity**:</span></span>

![Finestra di dialogo Impostazioni avanzate del pool di applicazione](index/_static/apppool-identity.png)

<span data-ttu-id="4a39e-499">Il processo di gestione IIS crea un identificatore sicuro con il nome del pool di app nel sistema di sicurezza di Windows.</span><span class="sxs-lookup"><span data-stu-id="4a39e-499">The IIS management process creates a secure identifier with the name of the app pool in the Windows Security System.</span></span> <span data-ttu-id="4a39e-500">Le risorse possono essere protette mediante questa identità,</span><span class="sxs-lookup"><span data-stu-id="4a39e-500">Resources can be secured using this identity.</span></span> <span data-ttu-id="4a39e-501">che tuttavia non è un account utente reale e non viene visualizzata nella console di gestione utenti di Windows.</span><span class="sxs-lookup"><span data-stu-id="4a39e-501">However, this identity isn't a real user account and doesn't show up in the Windows User Management Console.</span></span>

<span data-ttu-id="4a39e-502">Se il processo di lavoro IIS richiede l'accesso con privilegi elevati all'app, modificare l'elenco di controllo di accesso (ACL) della directory contenente l'app:</span><span class="sxs-lookup"><span data-stu-id="4a39e-502">If the IIS worker process requires elevated access to the app, modify the Access Control List (ACL) for the directory containing the app:</span></span>

1. <span data-ttu-id="4a39e-503">Aprire Esplora risorse, quindi spostarsi nella directory.</span><span class="sxs-lookup"><span data-stu-id="4a39e-503">Open Windows Explorer and navigate to the directory.</span></span>

1. <span data-ttu-id="4a39e-504">Fare clic con il pulsante destro del mouse sulla directory e scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-504">Right-click on the directory and select **Properties**.</span></span>

1. <span data-ttu-id="4a39e-505">Nella scheda **Sicurezza** selezionare il pulsante **Modifica** e quindi il pulsante **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-505">Under the **Security** tab, select the **Edit** button and then the **Add** button.</span></span>

1. <span data-ttu-id="4a39e-506">Fare clic sul pulsante **Percorsi** e verificare che il sistema sia selezionato.</span><span class="sxs-lookup"><span data-stu-id="4a39e-506">Select the **Locations** button and make sure the system is selected.</span></span>

1. <span data-ttu-id="4a39e-507">Immettere **IIS AppPool\\<nome_pool_applicazioni>** nell'area **Immettere i nomi degli oggetti da selezionare**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-507">Enter **IIS AppPool\\<app_pool_name>** in **Enter the object names to select** area.</span></span> <span data-ttu-id="4a39e-508">Fare clic sul pulsante **Controlla nomi**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-508">Select the **Check Names** button.</span></span> <span data-ttu-id="4a39e-509">Per *DefaultAppPool* controllare i nomi usando **IIS AppPool\DefaultAppPool**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-509">For the *DefaultAppPool* check the names using **IIS AppPool\DefaultAppPool**.</span></span> <span data-ttu-id="4a39e-510">Quando il pulsante **Controlla nomi** è selezionato, nell'area dei nomi degli oggetti viene indicato un valore di **DefaultAppPool**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-510">When the **Check Names** button is selected, a value of **DefaultAppPool** is indicated in the object names area.</span></span> <span data-ttu-id="4a39e-511">Non è possibile immettere il nome del pool di applicazioni direttamente nell'area dei nomi degli oggetti.</span><span class="sxs-lookup"><span data-stu-id="4a39e-511">It isn't possible to enter the app pool name directly into the object names area.</span></span> <span data-ttu-id="4a39e-512">Usare il formato **IIS AppPool\\<nome_pool_applicazioni>** durante il controllo dei nomi degli oggetti.</span><span class="sxs-lookup"><span data-stu-id="4a39e-512">Use the **IIS AppPool\\<app_pool_name>** format when checking for the object name.</span></span>

   ![Finestra di dialogo Seleziona utenti o gruppi per la cartella dell'app: il nome del pool di applicazioni "DefaultAppPool" viene aggiunto in coda a "IIS AppPool\" nell'area dei nomi degli oggetti prima di selezionare "Controlla nomi".](index/_static/select-users-or-groups-1.png)

1. <span data-ttu-id="4a39e-514">Scegliere **OK**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-514">Select **OK**.</span></span>

   ![Finestra di dialogo Seleziona utenti o gruppi per la cartella dell'app: dopo aver selezionato "Controlla nomi", il nome dell'oggetto "DefaultAppPool" viene visualizzato nell'area dei nomi degli oggetti.](index/_static/select-users-or-groups-2.png)

1. <span data-ttu-id="4a39e-516">Le autorizzazioni di lettura ed esecuzione devono essere concesse per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="4a39e-516">Read &amp; execute permissions should be granted by default.</span></span> <span data-ttu-id="4a39e-517">Fornire autorizzazioni aggiuntive in base alle necessità.</span><span class="sxs-lookup"><span data-stu-id="4a39e-517">Provide additional permissions as needed.</span></span>

<span data-ttu-id="4a39e-518">L'accesso può essere concesso anche dal prompt dei comandi usando lo strumento **ICACLS**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-518">Access can also be granted at a command prompt using the **ICACLS** tool.</span></span> <span data-ttu-id="4a39e-519">Usando *DefaultAppPool* come esempio, viene eseguito il comando seguente:</span><span class="sxs-lookup"><span data-stu-id="4a39e-519">Using the *DefaultAppPool* as an example, the following command is used:</span></span>

```console
ICACLS C:\sites\MyWebApp /grant "IIS AppPool\DefaultAppPool":F
```

<span data-ttu-id="4a39e-520">Per altre informazioni, vedere l'argomento [icacls](/windows-server/administration/windows-commands/icacls).</span><span class="sxs-lookup"><span data-stu-id="4a39e-520">For more information, see the [icacls](/windows-server/administration/windows-commands/icacls) topic.</span></span>

## <a name="http2-support"></a><span data-ttu-id="4a39e-521">Supporto per HTTP/2</span><span class="sxs-lookup"><span data-stu-id="4a39e-521">HTTP/2 support</span></span>

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="4a39e-522">[HTTP/2](https://httpwg.org/specs/rfc7540.html) è supportato con ASP.NET Core negli scenari di distribuzione IIS seguenti:</span><span class="sxs-lookup"><span data-stu-id="4a39e-522">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is supported with ASP.NET Core in the following IIS deployment scenarios:</span></span>

* <span data-ttu-id="4a39e-523">In-Process</span><span class="sxs-lookup"><span data-stu-id="4a39e-523">In-process</span></span>
  * <span data-ttu-id="4a39e-524">Windows Server 2016/Windows 10 o versioni successive; IIS 10 o versioni successive</span><span class="sxs-lookup"><span data-stu-id="4a39e-524">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
  * <span data-ttu-id="4a39e-525">Connessione TLS 1.2 o successiva</span><span class="sxs-lookup"><span data-stu-id="4a39e-525">TLS 1.2 or later connection</span></span>
* <span data-ttu-id="4a39e-526">Out-of-process</span><span class="sxs-lookup"><span data-stu-id="4a39e-526">Out-of-process</span></span>
  * <span data-ttu-id="4a39e-527">Windows Server 2016/Windows 10 o versioni successive; IIS 10 o versioni successive</span><span class="sxs-lookup"><span data-stu-id="4a39e-527">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
  * <span data-ttu-id="4a39e-528">Le connessioni server perimetrali pubbliche usano HTTP/2, mentre la connessione con proxy inverso al [server Kestrel](xref:fundamentals/servers/kestrel) usa HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="4a39e-528">Public-facing edge server connections use HTTP/2, but the reverse proxy connection to the [Kestrel server](xref:fundamentals/servers/kestrel) uses HTTP/1.1.</span></span>
  * <span data-ttu-id="4a39e-529">Connessione TLS 1.2 o successiva</span><span class="sxs-lookup"><span data-stu-id="4a39e-529">TLS 1.2 or later connection</span></span>

<span data-ttu-id="4a39e-530">Per una distribuzione In-Process, se viene stabilita una connessione HTTP/2, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) corrisponde a `HTTP/2`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-530">For an in-process deployment when an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/2`.</span></span> <span data-ttu-id="4a39e-531">Per una distribuzione out-of-process, se viene stabilita una connessione HTTP/2, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) corrisponde a `HTTP/1.1`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-531">For an out-of-process deployment when an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/1.1`.</span></span>

<span data-ttu-id="4a39e-532">Per altre informazioni sui modelli di hosting in-process e out-of-process, vedere <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="4a39e-532">For more information on the in-process and out-of-process hosting models, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="4a39e-533">[HTTP/2](https://httpwg.org/specs/rfc7540.html) è supportato per le distribuzioni out-of-process che soddisfano i requisiti seguenti:</span><span class="sxs-lookup"><span data-stu-id="4a39e-533">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is supported for out-of-process deployments that meet the following base requirements:</span></span>

* <span data-ttu-id="4a39e-534">Windows Server 2016/Windows 10 o versioni successive; IIS 10 o versioni successive</span><span class="sxs-lookup"><span data-stu-id="4a39e-534">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
* <span data-ttu-id="4a39e-535">Le connessioni server perimetrali pubbliche usano HTTP/2, mentre la connessione con proxy inverso al [server Kestrel](xref:fundamentals/servers/kestrel) usa HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="4a39e-535">Public-facing edge server connections use HTTP/2, but the reverse proxy connection to the [Kestrel server](xref:fundamentals/servers/kestrel) uses HTTP/1.1.</span></span>
* <span data-ttu-id="4a39e-536">Frame di destinazione: non applicabile alle distribuzioni out-of-process, in quanto la connessione HTTP/2 è gestita interamente da IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-536">Target framework: Not applicable to out-of-process deployments, since the HTTP/2 connection is handled entirely by IIS.</span></span>
* <span data-ttu-id="4a39e-537">Connessione TLS 1.2 o successiva</span><span class="sxs-lookup"><span data-stu-id="4a39e-537">TLS 1.2 or later connection</span></span>

<span data-ttu-id="4a39e-538">Se viene stabilita una connessione HTTP/2, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) corrisponde a `HTTP/1.1`.</span><span class="sxs-lookup"><span data-stu-id="4a39e-538">If an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/1.1`.</span></span>

::: moniker-end

<span data-ttu-id="4a39e-539">HTTP/2 è abilitato per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="4a39e-539">HTTP/2 is enabled by default.</span></span> <span data-ttu-id="4a39e-540">Se non viene stabilita una connessione HTTP/2, la connessione esegue il fallback a HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="4a39e-540">Connections fall back to HTTP/1.1 if an HTTP/2 connection isn't established.</span></span> <span data-ttu-id="4a39e-541">Per altre informazioni sulla configurazione di HTTP/2 con le distribuzioni IIS, vedere [HTTP/2 on IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis) (HTTP/2 in IIS).</span><span class="sxs-lookup"><span data-stu-id="4a39e-541">For more information on HTTP/2 configuration with IIS deployments, see [HTTP/2 on IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span></span>

## <a name="cors-preflight-requests"></a><span data-ttu-id="4a39e-542">Richieste preliminari CORS</span><span class="sxs-lookup"><span data-stu-id="4a39e-542">CORS preflight requests</span></span>

<span data-ttu-id="4a39e-543">*Questa sezione si applica solo alle app ASP.NET Core destinate a .NET Framework.*</span><span class="sxs-lookup"><span data-stu-id="4a39e-543">*This section only applies to ASP.NET Core apps that target the .NET Framework.*</span></span>

<span data-ttu-id="4a39e-544">Per un'app ASP.NET Core destinata a .NET Framework, le richieste OPTIONS non vengono passate all'app per impostazione predefinita in IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-544">For an ASP.NET Core app that targets the .NET Framework, OPTIONS requests aren't passed to the app by default in IIS.</span></span> <span data-ttu-id="4a39e-545">Per informazioni su come configurare i gestori IIS dell'app in *Web. config* per passare le richieste di opzioni, vedere [abilitare le richieste tra le origini in API Web ASP.NET 2:](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works)funzionamento di CORS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-545">To learn how to configure the app's IIS handlers in *web.config* to pass OPTIONS requests, see [Enable cross-origin requests in ASP.NET Web API 2: How CORS Works](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span></span>

::: moniker range=">= aspnetcore-2.2"

## <a name="application-initialization-module-and-idle-timeout"></a><span data-ttu-id="4a39e-546">Modulo di inizializzazione dell'applicazione e timeout di inattività</span><span class="sxs-lookup"><span data-stu-id="4a39e-546">Application Initialization Module and Idle Timeout</span></span>

<span data-ttu-id="4a39e-547">Per l'hosting in IIS dal modulo ASP.NET Core versione 2:</span><span class="sxs-lookup"><span data-stu-id="4a39e-547">When hosted in IIS by the ASP.NET Core Module version 2:</span></span>

* <span data-ttu-id="4a39e-548">[Modulo di inizializzazione dell'applicazione](#application-initialization-module) &ndash; L'app ospitata [in-process](#in-process-hosting-model) oppure [out-of-process](#out-of-process-hosting-model) può essere configurata per l'avvio automatico in un riavvio del processo di lavoro o un riavvio del server.</span><span class="sxs-lookup"><span data-stu-id="4a39e-548">[Application Initialization Module](#application-initialization-module) &ndash; App's hosted [in-process](#in-process-hosting-model) or [out-of-process](#out-of-process-hosting-model) can be configured to start automatically on a worker process restart or server restart.</span></span>
* <span data-ttu-id="4a39e-549">[Timeout di inattività](#idle-timeout) &ndash; L'app ospitata [in-process](#in-process-hosting-model) può essere configurata per non attivare il timeout durante periodi di inattività.</span><span class="sxs-lookup"><span data-stu-id="4a39e-549">[Idle Timeout](#idle-timeout) &ndash; App's hosted [in-process](#in-process-hosting-model) can be configured not to timeout during periods of inactivity.</span></span>

### <a name="application-initialization-module"></a><span data-ttu-id="4a39e-550">Modulo Inizializzazione applicazione</span><span class="sxs-lookup"><span data-stu-id="4a39e-550">Application Initialization Module</span></span>

<span data-ttu-id="4a39e-551">*Si applica alle app ospitate in-process e out-of-process.*</span><span class="sxs-lookup"><span data-stu-id="4a39e-551">*Applies to apps hosted in-process and out-of-process.*</span></span>

<span data-ttu-id="4a39e-552">[Inizializzazione applicazione di IIS](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization) è una funzionalità di IIS che invia una richiesta HTTP all'app quando il pool di app viene avviato o riciclato.</span><span class="sxs-lookup"><span data-stu-id="4a39e-552">[IIS Application Initialization](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization) is an IIS feature that sends an HTTP request to the app when the app pool starts or is recycled.</span></span> <span data-ttu-id="4a39e-553">La richiesta attiva l'avvio dell'app.</span><span class="sxs-lookup"><span data-stu-id="4a39e-553">The request triggers the app to start.</span></span> <span data-ttu-id="4a39e-554">Per impostazione predefinita, IIS invia una richiesta all'URL radice dell'app (`/`) per inizializzare l'app (vedere le [risorse aggiuntive](#application-initialization-module-and-idle-timeout-additional-resources) per altri dettagli sulla configurazione).</span><span class="sxs-lookup"><span data-stu-id="4a39e-554">By default, IIS issues a request to the app's root URL (`/`) to initialize the app (see the [additional resources](#application-initialization-module-and-idle-timeout-additional-resources) for more details on configuration).</span></span>

<span data-ttu-id="4a39e-555">Verificare che la funzionalità del ruolo Inizializzazione applicazione di IIS sia abilitata:</span><span class="sxs-lookup"><span data-stu-id="4a39e-555">Confirm that the IIS Application Initialization role feature in enabled:</span></span>

<span data-ttu-id="4a39e-556">Nei sistemi desktop Windows 7 o versioni successive quando si usa IIS in locale:</span><span class="sxs-lookup"><span data-stu-id="4a39e-556">On Windows 7 or later desktop systems when using IIS locally:</span></span>

1. <span data-ttu-id="4a39e-557">Passare a **Pannello di controllo** > **Programmi** > **Programmi e funzionalità** > **Disattivare o attivare le funzionalità di Windows** (a sinistra dello schermo).</span><span class="sxs-lookup"><span data-stu-id="4a39e-557">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>
1. <span data-ttu-id="4a39e-558">Aprire **Internet Information Services** > **Servizi Web** > **Funzionalità per lo sviluppo di applicazioni**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-558">Open **Internet Information Services** > **World Wide Web Services** > **Application Development Features**.</span></span>
1. <span data-ttu-id="4a39e-559">Selezionare la casella di controllo **Inizializzazione applicazione**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-559">Select the check box for **Application Initialization**.</span></span>

<span data-ttu-id="4a39e-560">In Windows Server 2008 R2 o versioni successive:</span><span class="sxs-lookup"><span data-stu-id="4a39e-560">On Windows Server 2008 R2 or later:</span></span>

1. <span data-ttu-id="4a39e-561">Aprire l'**Aggiunta guidata ruoli e funzionalità**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-561">Open the **Add Roles and Features Wizard**.</span></span>
1. <span data-ttu-id="4a39e-562">Nel pannello **Selezione servizi ruolo** aprire il nodo **Sviluppo applicazioni**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-562">In the **Select role services** panel, open the **Application Development** node.</span></span>
1. <span data-ttu-id="4a39e-563">Selezionare la casella di controllo **Inizializzazione applicazione**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-563">Select the check box for **Application Initialization**.</span></span>

<span data-ttu-id="4a39e-564">Per abilitare il modulo Inizializzazione applicazione per il sito, usare uno degli approcci seguenti:</span><span class="sxs-lookup"><span data-stu-id="4a39e-564">Use either of the following approaches to enable the Application Initialization Module for the site:</span></span>

* <span data-ttu-id="4a39e-565">In Gestione IIS:</span><span class="sxs-lookup"><span data-stu-id="4a39e-565">Using IIS Manager:</span></span>

  1. <span data-ttu-id="4a39e-566">Selezionare **Pool di applicazioni** nel pannello **Connessioni**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-566">Select **Application Pools** in the **Connections** panel.</span></span>
  1. <span data-ttu-id="4a39e-567">Fare clic con il pulsante destro del mouse sul pool di app dell'app nell'elenco e scegliere **Impostazioni avanzate**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-567">Right-click the app's app pool in the list and select **Advanced Settings**.</span></span>
  1. <span data-ttu-id="4a39e-568">L'impostazione predefinita per **Modalità avvio** è **OnDemand**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-568">The default **Start Mode** is **OnDemand**.</span></span> <span data-ttu-id="4a39e-569">Impostare **Modalità avvio** su **AlwaysRunning**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-569">Set the **Start Mode** to **AlwaysRunning**.</span></span> <span data-ttu-id="4a39e-570">Scegliere **OK**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-570">Select **OK**.</span></span>
  1. <span data-ttu-id="4a39e-571">Aprire il nodo **Siti** nel pannello **Connessioni**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-571">Open the **Sites** node in the **Connections** panel.</span></span>
  1. <span data-ttu-id="4a39e-572">Fare clic con il pulsante destro del mouse sull'app e scegliere **Gestisci sito Web** > **Impostazioni avanzate**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-572">Right-click the app and select **Manage Website** > **Advanced Settings**.</span></span>
  1. <span data-ttu-id="4a39e-573">L'impostazione predefinita di **Precaricamento abilitato** è **False**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-573">The default **Preload Enabled** setting is **False**.</span></span> <span data-ttu-id="4a39e-574">Impostare **Precaricamento abilitato** su **True**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-574">Set **Preload Enabled** to **True**.</span></span> <span data-ttu-id="4a39e-575">Scegliere **OK**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-575">Select **OK**.</span></span>

* <span data-ttu-id="4a39e-576">Usando *web.config* aggiungere l'elemento `<applicationInitialization>` con `doAppInitAfterRestart` impostato su `true` per gli elementi `<system.webServer>` nel file *web.config* dell'app:</span><span class="sxs-lookup"><span data-stu-id="4a39e-576">Using *web.config*, add the `<applicationInitialization>` element with `doAppInitAfterRestart` set to `true` to the `<system.webServer>` elements in the app's *web.config* file:</span></span>

  ```xml
  <?xml version="1.0" encoding="utf-8"?>
  <configuration>
    <location path="." inheritInChildApplications="false">
      <system.webServer>
        <applicationInitialization doAppInitAfterRestart="true" />
      </system.webServer>
    </location>
  </configuration>
  ```

### <a name="idle-timeout"></a><span data-ttu-id="4a39e-577">Timeout di inattività</span><span class="sxs-lookup"><span data-stu-id="4a39e-577">Idle Timeout</span></span>

<span data-ttu-id="4a39e-578">*Si applica solo alle app ospitate in-process.*</span><span class="sxs-lookup"><span data-stu-id="4a39e-578">*Only applies to apps hosted in-process.*</span></span>

<span data-ttu-id="4a39e-579">Per evitare l'inattività dell'app, impostare il timeout di inattività del pool di app tramite Gestione IIS:</span><span class="sxs-lookup"><span data-stu-id="4a39e-579">To prevent the app from idling, set the app pool's idle timeout using IIS Manager:</span></span>

1. <span data-ttu-id="4a39e-580">Selezionare **Pool di applicazioni** nel pannello **Connessioni**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-580">Select **Application Pools** in the **Connections** panel.</span></span>
1. <span data-ttu-id="4a39e-581">Fare clic con il pulsante destro del mouse sul pool di app dell'app nell'elenco e scegliere **Impostazioni avanzate**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-581">Right-click the app's app pool in the list and select **Advanced Settings**.</span></span>
1. <span data-ttu-id="4a39e-582">L'impostazione predefinita di **Timeout di inattività (minuti)** è **20** minuti.</span><span class="sxs-lookup"><span data-stu-id="4a39e-582">The default **Idle Time-out (minutes)** is **20** minutes.</span></span> <span data-ttu-id="4a39e-583">Impostare **Timeout di inattività (minuti)** su **0** (zero).</span><span class="sxs-lookup"><span data-stu-id="4a39e-583">Set the **Idle Time-out (minutes)** to **0** (zero).</span></span> <span data-ttu-id="4a39e-584">Scegliere **OK**.</span><span class="sxs-lookup"><span data-stu-id="4a39e-584">Select **OK**.</span></span>
1. <span data-ttu-id="4a39e-585">Riciclare il processo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="4a39e-585">Recycle the worker process.</span></span>

<span data-ttu-id="4a39e-586">Per evitare il timeout delle app ospitate [out-of-process](#out-of-process-hosting-model), usare uno degli approcci seguenti:</span><span class="sxs-lookup"><span data-stu-id="4a39e-586">To prevent apps hosted [out-of-process](#out-of-process-hosting-model) from timing out, use either of the following approaches:</span></span>

* <span data-ttu-id="4a39e-587">Effettuare il ping dell'app da un servizio esterno per mantenerla in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="4a39e-587">Ping the app from an external service in order to keep it running.</span></span>
* <span data-ttu-id="4a39e-588">Se l'app ospita solo servizi in background, evitare l'hosting IIS e usare un [servizio Windows per ospitare l'app ASP.NET Core](xref:host-and-deploy/windows-service).</span><span class="sxs-lookup"><span data-stu-id="4a39e-588">If the app only hosts background services, avoid IIS hosting and use a [Windows Service to host the ASP.NET Core app](xref:host-and-deploy/windows-service).</span></span>

### <a name="application-initialization-module-and-idle-timeout-additional-resources"></a><span data-ttu-id="4a39e-589">Risorse aggiuntive per il modulo Inizializzazione applicazione e il timeout di inattività</span><span class="sxs-lookup"><span data-stu-id="4a39e-589">Application Initialization Module and Idle Timeout additional resources</span></span>

* <span data-ttu-id="4a39e-590">[IIS 8.0 Application Initialization](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization) (Inizializzazione delle applicazioni in IIS 8.0)</span><span class="sxs-lookup"><span data-stu-id="4a39e-590">[IIS 8.0 Application Initialization](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization)</span></span>
* <span data-ttu-id="4a39e-591">[Application Initialization \<applicationInitialization>](/iis/configuration/system.webserver/applicationinitialization/) (Inizializzazione delle applicazioni <applicationInitialization>).</span><span class="sxs-lookup"><span data-stu-id="4a39e-591">[Application Initialization \<applicationInitialization>](/iis/configuration/system.webserver/applicationinitialization/).</span></span>
* <span data-ttu-id="4a39e-592">[Process Model Settings for an Application Pool \<processModel>](/iis/configuration/system.applicationhost/applicationpools/add/processmodel) (Impostazioni del modello di processo per un pool di applicazioni <processModel>).</span><span class="sxs-lookup"><span data-stu-id="4a39e-592">[Process Model Settings for an Application Pool \<processModel>](/iis/configuration/system.applicationhost/applicationpools/add/processmodel).</span></span>

::: moniker-end

## <a name="deployment-resources-for-iis-administrators"></a><span data-ttu-id="4a39e-593">Risorse di distribuzione per amministratori IIS</span><span class="sxs-lookup"><span data-stu-id="4a39e-593">Deployment resources for IIS administrators</span></span>

<span data-ttu-id="4a39e-594">Informazioni approfondite su IIS nella documentazione di IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-594">Learn about IIS in-depth in the IIS documentation.</span></span>  
[<span data-ttu-id="4a39e-595">Documentazione di ISS</span><span class="sxs-lookup"><span data-stu-id="4a39e-595">IIS documentation</span></span>](/iis)

<span data-ttu-id="4a39e-596">Informazioni sui modelli di distribuzione di app .NET Core.</span><span class="sxs-lookup"><span data-stu-id="4a39e-596">Learn about .NET Core app deployment models.</span></span>  
[<span data-ttu-id="4a39e-597">Distribuzione di applicazioni .NET Core</span><span class="sxs-lookup"><span data-stu-id="4a39e-597">.NET Core application deployment</span></span>](/dotnet/core/deploying/)

<span data-ttu-id="4a39e-598">Informazioni su come il modulo ASP.NET Core consente al server Web Kestrel di usare IIS o IIS Express come server proxy inverso.</span><span class="sxs-lookup"><span data-stu-id="4a39e-598">Learn how the ASP.NET Core Module allows the Kestrel web server to use IIS or IIS Express as a reverse proxy server.</span></span>  
[<span data-ttu-id="4a39e-599">Modulo ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="4a39e-599">ASP.NET Core Module</span></span>](xref:host-and-deploy/aspnet-core-module)

<span data-ttu-id="4a39e-600">Informazioni su come configurare il modulo di ASP.NET Core per l'hosting di app ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="4a39e-600">Learn how to configure the ASP.NET Core Module for hosting ASP.NET Core apps.</span></span>  
[<span data-ttu-id="4a39e-601">Guida di riferimento per la configurazione del modulo ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="4a39e-601">ASP.NET Core Module configuration reference</span></span>](xref:host-and-deploy/aspnet-core-module)

<span data-ttu-id="4a39e-602">Informazioni sulla struttura di directory delle app ASP.NET Core pubblicate.</span><span class="sxs-lookup"><span data-stu-id="4a39e-602">Learn about the directory structure of published ASP.NET Core apps.</span></span>  
[<span data-ttu-id="4a39e-603">Struttura di directory</span><span class="sxs-lookup"><span data-stu-id="4a39e-603">Directory structure</span></span>](xref:host-and-deploy/directory-structure)

<span data-ttu-id="4a39e-604">Individuare i moduli IIS attivi e inattivi per le app ASP.NET Core e come gestire i moduli IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-604">Discover active and inactive IIS modules for ASP.NET Core apps and how to manage IIS modules.</span></span>  
[<span data-ttu-id="4a39e-605">Moduli IIS</span><span class="sxs-lookup"><span data-stu-id="4a39e-605">IIS modules</span></span>](xref:host-and-deploy/iis/modules)

<span data-ttu-id="4a39e-606">Informazioni su come diagnosticare i problemi delle distribuzioni IIS di app ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="4a39e-606">Learn how to diagnose problems with IIS deployments of ASP.NET Core apps.</span></span>  
[<span data-ttu-id="4a39e-607">Risolvere i problemi</span><span class="sxs-lookup"><span data-stu-id="4a39e-607">Troubleshoot</span></span>](xref:test/troubleshoot-azure-iis)

<span data-ttu-id="4a39e-608">Riconoscere errori comuni dell'hosting di app ASP.NET Core in IIS.</span><span class="sxs-lookup"><span data-stu-id="4a39e-608">Distinguish common errors when hosting ASP.NET Core apps on IIS.</span></span>  
[<span data-ttu-id="4a39e-609">Errori comuni di Azure App Service e IIS</span><span class="sxs-lookup"><span data-stu-id="4a39e-609">Common errors reference for Azure App Service and IIS</span></span>](xref:host-and-deploy/azure-iis-errors-reference)

## <a name="additional-resources"></a><span data-ttu-id="4a39e-610">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="4a39e-610">Additional resources</span></span>

* <xref:test/troubleshoot>
* [<span data-ttu-id="4a39e-611">Introduzione a ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="4a39e-611">Introduction to ASP.NET Core</span></span>](xref:index)
* [<span data-ttu-id="4a39e-612">Il sito IIS ufficiale di Microsoft</span><span class="sxs-lookup"><span data-stu-id="4a39e-612">The Official Microsoft IIS Site</span></span>](https://www.iis.net/)
* [<span data-ttu-id="4a39e-613">Libreria di contenuti tecnici di Windows Server</span><span class="sxs-lookup"><span data-stu-id="4a39e-613">Windows Server technical content library</span></span>](/windows-server/windows-server)
* [<span data-ttu-id="4a39e-614">HTTP/2 in IIS</span><span class="sxs-lookup"><span data-stu-id="4a39e-614">HTTP/2 on IIS</span></span>](/iis/get-started/whats-new-in-iis-10/http2-on-iis)
* <xref:host-and-deploy/iis/transform-webconfig>
